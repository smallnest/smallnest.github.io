<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Linux TCP/IP 协议栈调优 | 鸟窝</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="最近忙于系统性能的DEBUG和调优。 有些性能瓶颈和Linux的TCP/IP的协议栈的设置有关，所以特别google了一下Linux TCP/IP的协议栈的参数意义和配置，记录一下。如果想永久的保存参数的设置， 可以将参数加入到/etc/sysctl.conf中。如果想临时的更改参数的配置， 可以修改/proc/sys/net/ipv4/下的参数， 机器重启后更改失效。">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux TCP/IP 协议栈调优">
<meta property="og:url" content="http://colobu.com/2014/09/18/linux-tcpip-tuning/">
<meta property="og:site_name" content="鸟窝">
<meta property="og:description" content="最近忙于系统性能的DEBUG和调优。 有些性能瓶颈和Linux的TCP/IP的协议栈的设置有关，所以特别google了一下Linux TCP/IP的协议栈的参数意义和配置，记录一下。如果想永久的保存参数的设置， 可以将参数加入到/etc/sysctl.conf中。如果想临时的更改参数的配置， 可以修改/proc/sys/net/ipv4/下的参数， 机器重启后更改失效。">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Linux TCP/IP 协议栈调优">
<meta name="twitter:description" content="最近忙于系统性能的DEBUG和调优。 有些性能瓶颈和Linux的TCP/IP的协议栈的设置有关，所以特别google了一下Linux TCP/IP的协议栈的参数意义和配置，记录一下。如果想永久的保存参数的设置， 可以将参数加入到/etc/sysctl.conf中。如果想临时的更改参数的配置， 可以修改/proc/sys/net/ipv4/下的参数， 机器重启后更改失效。">

  
    <link rel="alternative" href="/atom.xml" title="鸟窝" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">

  <link href="//cdn.staticfile.org/font-awesome/4.2.0/css/font-awesome.css" rel="stylesheet">
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/css/jquery.fancybox.min.css" media="screen" type="text/css">
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//cdn.staticfile.org/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->

  <script type="text/javascript">
	//visit my previous blog: http://old.colobu.com just like this http://colobu.com/?=123456
    var blog_url = location.href.toString();
	if (blog_url.indexOf("http://colobu.com/?p=") >= 0) {
		blog_url = blog_url.replace("colobu.com", "old.colobu.com");
		window.location.assign(blog_url);
	} else if (blog_url.indexOf("http://smallnest.gitcafe.com") >= 0) {
		blog_url = blog_url.replace("smallnest.gitcafe.com", "colobu.com");
		window.location.assign(blog_url);
	}  else if (blog_url.indexOf("http://smallnest.gitcafe.io") >= 0) {
		blog_url = blog_url.replace("smallnest.gitcafe.io", "colobu.com");
		window.location.assign(blog_url);
	}
</script>
  <style type="text/css">
    .news-essay
    {
      display: inline !important;
    }
    .hot-news
    {
      text-align: left !important;
    }
  </style>
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap" class="animated bounceInLeft">
        <a href="/" id="logo">鸟窝</a>
      </h1>
      
        <h2 id="subtitle-wrap" class="animated bounceInLeft">
          <a href="/" id="subtitle">大道至简 Simplicity is the ultimate form of sophistication</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/"><i class="fa fa-home">&nbsp;</i>首页</a>
        
          <a class="main-nav-link" href="/archives"><i class="fa fa-folder-o">&nbsp;</i>归档</a>
        
          <a class="main-nav-link" href="https://github.com/smallnest"><i class="fa fa-github">&nbsp;</i>github</a>
        
          <a class="main-nav-link" href="/goasm"><i class="fa fa-language">&nbsp;</i>Go汇编示例</a>
        
          <a class="main-nav-link" href="/ScalaCollectionsCookbook"><i class="fa fa-book">&nbsp;</i>Scala集合技术手册</a>
        
          <a class="main-nav-link" href="/techreview"><i class="fa fa-newspaper-o">&nbsp;</i>技术快报</a>
        
          <a class="main-nav-link" href="/about"><i class="fa fa-lemon-o">&nbsp;</i>关于</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="http://www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
          <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="Search">
          <input type="submit" value="" class="search-form-submit">
          <input name=tn type=hidden value="bds">
          <input name=cl type=hidden value="3">
          <input name=ct type=hidden value="2097152">
          <input type="hidden" name="si" value="colobu.com">
        </form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-linux-tcpip-tuning" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/09/18/linux-tcpip-tuning/" class="article-date">
  <time datetime="2014-09-18T00:36:17.000Z" itemprop="datePublished">2014年09月18日</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/高并发编程/">高并发编程</a>
  </div>

	
  <div class="article-author"> by smallnest</div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Linux TCP/IP 协议栈调优
	  
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
	  
	  
      
        <p>最近忙于系统性能的DEBUG和调优。 有些性能瓶颈和Linux的TCP/IP的协议栈的设置有关，所以特别google了一下Linux TCP/IP的协议栈的参数意义和配置，记录一下。<br>如果想永久的保存参数的设置， 可以将参数加入到/etc/sysctl.conf中。如果想临时的更改参数的配置， 可以修改/proc/sys/net/ipv4/下的参数， 机器重启后更改失效。<br><a id="more"></a></p>
<hr>
<p><a href="http://yangrong.blog.51cto.com/6945369/1321594" target="_blank" rel="external">杨云1028</a>整理的参数的说明：<br>参考文章：<br>linux内核TCP相关参数解释<br><a href="http://os.chinaunix.net/a2008/0918/985/000000985483.shtml" target="_blank" rel="external">http://os.chinaunix.net/a2008/0918/985/000000985483.shtml</a></p>
<p>linux内核参数优化<br><a href="http://blog.chinaunix.net/uid-29081804-id-3830203.html" target="_blank" rel="external">http://blog.chinaunix.net/uid-29081804-id-3830203.html</a></p>
<h3 id="linux内核参数注释">linux内核参数注释</h3>
<p>根据参数文件所处目录不同而进行分表整理<br><strong>下列文件所在目录：/proc/sys/net/ipv4/</strong></p>
<table style="width:100%;" cellpadding="0" cellspacing="0"><tbody><tr><td style="border-color:#000000;border-width:1px;background-color:#d9d9d9;padding:0px 7px;" width="274"><p style="text-align:center;"><span>名称</span></p></td><td style="border-top-color:#000000;border-right-color:#000000;border-bottom-color:#000000;border-top-width:1px;border-right-width:1px;border-bottom-width:1px;border-left-style:none;background-color:#d9d9d9;padding:0px 7px;" width="66"><p style="text-align:center;"><span>默认值</span></p></td><td style="border-top-color:#000000;border-right-color:#000000;border-bottom-color:#000000;border-top-width:1px;border-right-width:1px;border-bottom-width:1px;border-left-style:none;background-color:#d9d9d9;padding:0px 7px;" width="95"><p style="text-align:center;"><span>建议值</span></p></td><td style="border-top-color:#000000;border-right-color:#000000;border-bottom-color:#000000;border-top-width:1px;border-right-width:1px;border-bottom-width:1px;border-left-style:none;background-color:#d9d9d9;padding:0px 7px;" valign="top" width="455"><p><span>描述</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;color:#ff0000;">tcp_syn_retries</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">5</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">1</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>对于一个新建连接，内核要发送多少个</span> SYN <span>连接请求才决定放弃。不应该大于</span>255<span>，默认值是</span>5<span>，对应于</span>180<span>秒左右时间。。</span>(<span>对于大负载而物理通信良好的网络而言</span>,<span>这个值偏高</span>,<span>可修改为</span>2.<span>这个值仅仅是针对对外的连接</span>,<span>对进来的连接</span>,<span>是由</span><strong><span style="font-family:cambria, serif;">tcp_retries1</span></strong><span>决定的</span>)</p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;color:#ff0000;">tcp_synack_retries</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">5</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">1</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>对于远端的连接请求</span>SYN<span>，内核会发送</span>SYN <span>＋</span> ACK<span>数据报，以确认收到上一个</span> SYN<span>连接请求包。</span><span>这是所谓的三次握手</span>( threeway handshake)<span>机制的第二个步骤。这里决定内核在放弃连接之前所送出的</span> SYN+ACK <span>数目。不应该大于</span>255<span>，默认值是</span>5<span>，对应于</span>180<span>秒左右时间。</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;color:#ff0000;">tcp_keepalive_time</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">7200</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">600</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span style="font-size:15px;line-height:115%;">TCP</span><span style="font-size:15px;line-height:115%;">发送</span><span style="font-size:15px;line-height:115%;">keepalive</span><span style="font-size:15px;line-height:115%;">探测消息的间隔时间（秒），用于确认</span><span style="font-size:15px;line-height:115%;">TCP</span><span style="font-size:15px;line-height:115%;">连接是否有效。</span></p><p><span>防止两边建立连接但不发送数据的攻击。</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;color:#ff0000;">tcp_keepalive_probes</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">9</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">3</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span style="font-size:15px;line-height:115%;">TCP</span><span style="font-size:15px;line-height:115%;">发送</span><span style="font-size:15px;line-height:115%;">keepalive</span><span style="font-size:15px;line-height:115%;">探测消息的间隔时间（秒），用于确认</span><span style="font-size:15px;line-height:115%;">TCP</span><span style="font-size:15px;line-height:115%;">连接是否有效。</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;color:#ff0000;">tcp_keepalive_intvl</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">75</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">15</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span style="font-size:15px;line-height:115%;">探测消息未获得响应时，重发该消息的间隔时间（秒）。</span><span>默认值为</span>75<span>秒。</span> (<span>对于普通应用来说</span>,<span>这个值有一些偏大</span>,<span>可以根据需要改小</span>.<span>特别是</span>web<span>类服务器需要改小该值</span>,15<span>是个比较合适的值</span>)</p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;">tcp_retries1</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">3</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">3</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>放弃回应一个</span>TCP<span>连接请求前﹐需要进行多少次重试。</span>RFC <span>规定最低的数值是</span>3</p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;color:#ff0000;">tcp_retries2</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">15</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">5</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>在丢弃激活</span>(<span>已建立通讯状况</span>)<span>的</span>TCP<span>连接之前﹐需要进行多少次重试。默认值为</span>15<span>，根据</span>RTO<span>的值来决定，相当于</span>13-30<span>分钟</span>(RFC1122<span>规定，必须大于</span>100<span>秒</span>).(<span>这个值根据目前的网络设置</span>,<span>可以适当地改小</span>,<span>我的网络内修改为了</span>5)</p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;">tcp_orphan_retries</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">7</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">3</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>在近端丢弃</span>TCP<span>连接之前﹐要进行多少次重试。默认值是</span>7<span>个﹐相当于</span> 50<span>秒</span> - 16<span>分钟﹐视</span> RTO <span>而定。如果您的系统是负载很大的</span>web<span>服务器﹐那么也许需要降低该值﹐这类</span> sockets <span>可能会耗费大量的资源。另外参的考</span><strong><span style="font-family:cambria, serif;">tcp_max_orphans</span></strong><span>。</span>(<span>事实上做</span>NAT<span>的时候</span>,<span>降低该值也是好处显著的</span>,<span>我本人的网络环境中降低该值为</span>3)</p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;color:#ff0000;">tcp_fin_timeout</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">60</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">2</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>对于本端断开的</span>socket<span>连接，</span>TCP<span>保持在</span>FIN-WAIT-2<span>状态的时间。对方可能会断开连接或一直不结束连接或不可预料的进程死亡。</span><span>默认值为</span> 60 <span>秒。</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;color:#ff0000;">tcp_max_tw_buckets</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">180000</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;"><span style="font-size:13px;line-height:115%;font-family:arial, sans-serif;">36000</span></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>系统在同时所处理的最大</span> timewait sockets <span>数目。如果超过此数的话﹐</span>time-wait socket <span>会被立即砍除并且显示警告信息。之所以要设定这个限制﹐纯粹为了抵御那些简单的</span> DoS <span>攻击﹐不过﹐如果网络条件需要比默认值更多﹐则可以提高它</span>(<span>或许还要增加内存</span>)<span>。</span>(<span>事实上做</span>NAT<span>的时候最好可以适当地增加该值</span>)</p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;color:#ff0000;">tcp_tw_recycle</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">0</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">1</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>打开快速</span> TIME-WAIT sockets <span>回收。除非得到技术专家的建议或要求﹐请不要随意修改这个值。</span>(<span>做</span>NAT<span>的时候，建议打开它</span>)</p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;color:#ff0000;">tcp_tw_reuse</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">0</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">1</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>表示是否允许重新应用处于</span>TIME-WAIT<span>状态的</span>socket<span>用于新的</span>TCP<span>连接</span>(<span>这个对快速重启动某些服务</span>,<span>而启动后提示端口已经被使用的情形非常有帮助</span>)</p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;color:#ff0000;">tcp_max_orphans</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">8192</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">32768</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>系统所能处理不属于任何进程的</span>TCP sockets<span>最大数量。假如超过这个数量﹐那么不属于任何进程的连接会被立即</span>reset<span>，并同时显示警告信息。之所以要设定这个限制﹐纯粹为了抵御那些简单的</span> DoS <span>攻击﹐千万不要依赖这个或是人为的降低这个限制。如果内存大更应该增加这个值。</span>(<span>这个值</span>Redhat AS<span>版本中设置为</span>32768,<span>但是很多防火墙修改的时候</span>,<span>建议该值修改为</span>2000)</p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;">tcp_abort_on_overflow</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">0</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">0</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>当守护进程太忙而不能接受新的连接，就象对方发送</span>reset<span>消息，默认值是</span>false<span>。这意味着当溢出的原因是因为一个偶然的猝发，那么连接将恢复状态。只有在你确信守护进程真的不能完成连接请求时才打开该选项，该选项会影响客户的使用。</span>(<span>对待已经满载的</span>sendmail,apache<span>这类服务的时候</span>,<span>这个可以很快让客户端终止连接</span>,<span>可以给予服务程序处理已有连接的缓冲机会</span>,<span>所以很多防火墙上推荐打开它</span>)</p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;color:#ff0000;">tcp_syncookies</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">0</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">1</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>只有在内核编译时选择了</span>CONFIG_SYNCOOKIES<span>时才会发生作用。当出现</span>syn<span>等候队列出现溢出时象对方发送</span>syncookies<span>。</span><span>目的是为了防止</span>syn flood<span>攻击。</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;">tcp_stdurg</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">0</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">0</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>使用</span> TCP urg pointer <span>字段中的主机请求解释功能。大部份的主机都使用老旧的</span> BSD<span>解释，因此如果您在</span> Linux <span>打开它﹐或会导致不能和它们正确沟通。</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;color:#ff0000;">tcp_max_syn_backlog</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">1024</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">16384</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>对于那些依然还未获得客户端确认的连接请求﹐需要保存在队列中最大数目。对于超过</span> 128Mb <span>内存的系统﹐默认值是</span> 1024 <span>﹐低于</span> 128Mb <span>的则为</span> 128<span>。如果服务器经常出现过载﹐可以尝试增加这个数字。警告﹗假如您将此值设为大于</span> 1024<span>﹐最好修改</span><span style="font-family:cambria, serif;">include/net/tcp.h</span><span>里面的</span><span style="font-family:cambria, serif;">TCP_SYNQ_HSIZE</span><span>﹐以保持</span><span style="font-family:cambria, serif;">TCP_SYNQ_HSIZE<em>16(SYN Flood</em></span><span>攻击利用</span><span style="font-family:cambria, serif;">TCP</span><span>协议散布握手的缺陷，伪造虚假源</span><span style="font-family:cambria, serif;">IP</span><span>地址发送大量</span><span style="font-family:cambria, serif;">TCP-SYN</span><span>半打开连接到目标系统，最终导致目标系统</span><span style="font-family:cambria, serif;">Socket</span><span>队列资源耗尽而无法接受新的连接。为了应付这种攻击，现代</span><span style="font-family:cambria, serif;">Unix</span><span>系统中普遍采用多连接队列处理的方式来缓冲</span><span style="font-family:cambria, serif;">(</span><span>而不是解决</span><span style="font-family:cambria, serif;">)</span><span>这种攻击，是用一个基本队列处理正常的完全连接应用</span><span style="font-family:cambria, serif;">(Connect()</span><span>和</span><span style="font-family:cambria, serif;">Accept() )</span><span>，是用另一个队列单独存放半打开连接。</span><span>这种双队列处理方式和其他一些系统内核措施</span><span style="font-family:cambria, serif;">(</span><span>例如</span><span style="font-family:cambria, serif;">Syn-Cookies/Caches)</span><span>联合应用时，能够比较有效的缓解小规模的</span><span style="font-family:cambria, serif;">SYN Flood</span><span>攻击</span><span style="font-family:cambria, serif;">(</span><span>事实证明</span><span style="font-family:cambria, serif;">)</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;">tcp_window_scaling</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">1</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">1</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>该文件表示设置</span>tcp/ip<span>会话的滑动窗口大小是否可变。参数值为布尔值，为</span>1<span>时表示可变，为</span>0<span>时表示不可变。</span>tcp/ip<span>通常使用的窗口最大可达到</span> 65535 <span>字节，对于高速网络，该值可能太小，这时候如果启用了该功能，可以使</span>tcp/ip<span>滑动窗口大小增大数个数量级，从而提高数据传输的能力</span>(RFC 1323)<span>。（对普通地百</span>M<span>网络而言，关闭会降低开销，所以如果不是高速网络，可以考虑设置为</span>0<span>）</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;">tcp_timestamps</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">1</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">1</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p>Timestamps <span>用在其它一些东西中﹐可以防范那些伪造的</span> sequence <span>号码。一条</span>1G<span>的宽带线路或许会重遇到带</span> out-of-line<span>数值的旧</span>sequence <span>号码</span>(<span>假如它是由于上次产生的</span>)<span>。</span>Timestamp <span>会让它知道这是个</span> &#39;<span>旧封包</span>&#39;<span>。</span>(<span>该文件表示是否启用以一种比超时重发更精确的方法（</span>RFC 1323<span>）来启用对</span> RTT <span>的计算；为了实现更好的性能应该启用这个选项。</span>)</p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;">tcp_sack</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">1</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">1</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>使用</span> Selective ACK<span>﹐它可以用来查找特定的遗失的数据报</span>--- <span>因此有助于快速恢复状态。该文件表示是否启用有选择的应答（</span>Selective Acknowledgment<span>），这可以通过有选择地应答乱序接收到的报文来提高性能（这样可以让发送者只发送丢失的报文段）。</span>(<span>对于广域网通信来说这个选项应该启用，但是这会增加对</span> CPU <span>的占用。</span>)</p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;">tcp_fack</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">1</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">1</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>打开</span>FACK<span>拥塞避免和快速重传功能。</span>(<span>注意，当</span><strong><span style="font-family:cambria, serif;">tcp_sack</span></strong><span>设置为</span>0<span>的时候，这个值即使设置为</span>1<span>也无效</span>)[<span style="color:#ff0000;">这个是</span><span style="color:#ff0000;">TCP</span><span style="color:#ff0000;">连接靠谱的核心功能</span>]</p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;">tcp_dsack</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">1</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">1</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>允许</span>TCP<span>发送</span>&quot;<span>两个完全相同</span>&quot;<span>的</span>SACK<span>。</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;">tcp_ecn</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">0</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">0</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p>TCP<span>的直接拥塞通告功能。</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;">tcp_reordering</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">3</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">6</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p>TCP<span>流中重排序的数据报最大数量</span><span>。</span> (<span>一般有看到推荐把这个数值略微调整大一些</span>,<span>比如</span>5)</p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;">tcp_retrans_collapse</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">1</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">0</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>对于某些有</span>bug<span>的打印机提供针对其</span>bug<span>的兼容性。</span>(<span>一般不需要这个支持</span>,<span>可以关闭它</span>)</p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><a></a><a><strong><span style="font-family:cambria, serif;color:#ff0000;">tcp_wmem</span></strong></a><strong><span style="color:#ff0000;">：</span><span style="color:#ff0000;"><strong><span style="font-family:cambria, serif;">min</span></strong></span></strong><strong><strong><span style="font-family:cambria, serif;color:#ff0000;">default</span></strong></strong><strong><span style="color:#ff0000;"><strong><span style="font-family:cambria, serif;">max</span></strong></span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">4096 </p><p style="text-align:center;">16384 </p><p style="text-align:center;">131072</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">8192 </p><p style="text-align:center;">131072 </p><p style="text-align:center;"><span style="font-size:13px;line-height:115%;font-family:arial, sans-serif;">16777216</span></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p style="margin-bottom:0;"><span style="font-size:14px;">发送缓存设置</span></p><p style="margin-bottom:0;"><span style="font-size:14px;">min</span><span style="font-size:14px;">：为TCP socket预留用于发送缓冲的内存最小值。每个tcp socket都可以在建议以后都可以使用它。默认值为4096(4K)。</span></p><p style="margin-bottom:0;"><span style="font-size:14px;">default</span><span style="font-size:14px;">：为TCP socket预留用于发送缓冲的内存数量，默认情况下该值会影响其它协议使用的net.core.wmem_default 值，一般要低于net.core.wmem_default的值。默认值为16384(16K)。</span></p><p style="margin-bottom:0;"><span style="font-size:14px;">max: </span><span style="font-size:14px;">用于TCP socket发送缓冲的内存最大值。该值不会影响net.core.wmem_max，&quot;静态&quot;选择参数SO<em>SNDBUF则不受该值影响。默认值为131072(128K)。（对于服务器而言，增加这个参数的值对于发送数据很有帮助,在我的网络环境中,修改为了51200 131072 204800）</em></span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;color:#ff0000;">tcp</span></strong><strong><span style="font-family:cambria, serif;color:#ff0000;">r</span></strong><strong><span style="font-family:cambria, serif;color:#ff0000;">mem</span></strong><strong><span style="color:#ff0000;">：</span><span style="color:#ff0000;"><strong><span style="font-family:cambria, serif;">min</span></strong></span></strong><strong><strong><span style="font-family:cambria, serif;color:#ff0000;">default</span></strong></strong><strong><span style="color:#ff0000;"><strong><span style="font-family:cambria, serif;">max</span></strong></span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;"><span style="font-size:13px;line-height:115%;font-family:arial, sans-serif;">4096</span><span style="font-size:13px;line-height:115%;font-family:arial, sans-serif;"></span></p><p style="text-align:center;"><span style="font-size:13px;line-height:115%;font-family:arial, sans-serif;">87380 </span></p><p style="text-align:center;"><span style="font-size:13px;line-height:115%;font-family:arial, sans-serif;">174760</span></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;"><span style="font-size:15px;line-height:115%;font-family:arial, sans-serif;">32768 </span></p><p style="text-align:center;"><span style="font-size:15px;line-height:115%;font-family:arial, sans-serif;">131072 </span></p><p style="text-align:center;"><span style="font-size:13px;line-height:115%;font-family:arial, sans-serif;">16777216</span></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>接收缓存设置</span></p><p><span>同</span>tcp_wmem</p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;color:#ff0000;">tcp_mem</span></strong><strong><span style="color:#ff0000;">：</span><span style="color:#ff0000;"><strong><span style="font-family:cambria, serif;">min</span></strong></span></strong><strong><strong><span style="font-family:cambria, serif;color:#ff0000;">default</span></strong></strong><strong><span style="color:#ff0000;"><strong><span style="font-family:cambria, serif;">max</span></strong></span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;"><span>根据内存计算</span></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;"><span style="font-size:13px;line-height:115%;font-family:arial, sans-serif;">786432 </span></p><p style="text-align:center;"><span style="font-size:13px;line-height:115%;font-family:arial, sans-serif;">1048576 1572864</span></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p style="margin-bottom:0;"><strong><span style="font-size:16px;">low</span></strong><span style="font-size:16px;">：当TCP使用了低于该值的内存页面数时，TCP不会考虑释放内存。即低于此值没有内存压力。(理想情况下，这个值应与指定给 tcp_wmem 的第 2 个值相匹配 - 这第 2 个值表明，最大页面大小乘以最大并发请求数除以页大小 (131072  300 / 4096)。 )</span></p><p style="margin-bottom:0;"><strong><span style="font-size:16px;">pressure</span></strong><span style="font-size:16px;">：当TCP使用了超过该值的内存页面数量时，TCP试图稳定其内存使用，进入pressure模式，当内存消耗低于low值时则退出pressure状态。(理想情况下这个值应该是 TCP 可以使用的总缓冲区大小的最大值 (204800 <em> 300 / 4096)。 )</em></span></p><p style="margin-bottom:0;"><strong><span style="font-size:16px;">high</span></strong><span style="font-size:16px;">：允许所有tcp sockets用于排队缓冲数据报的页面量。(如果超过这个值，TCP 连接将被拒绝，这就是为什么不要令其过于保守 (512000  300 / 4096) 的原因了。 在这种情况下，提供的价值很大，它能处理很多连接，是所预期的 2.5 倍；或者使现有连接能够传输 2.5 倍的数据。 我的网络里为192000 300000 732000)</span></p><p style="margin-bottom:0;"><span style="font-size:16px;">一般情况下这些值是在系统启动时根据系统内存数量计算得到的。</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;">tcp_app_win</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">31</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">31</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>保留</span>max(window/2^tcp_app_win, mss)<span>数量的窗口由于应用缓冲。当为</span>0<span>时表示不需要缓冲。</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;">tcp_adv_win_scale</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">2</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">2</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>计算缓冲开销</span>bytes/2^tcp_adv_win_scale(<span>如果</span>tcp_adv_win_scale &gt; 0)<span>或者</span>bytes-bytes/2^(-tcp_adv_win_scale)(<span>如果</span>tcp_adv_win_scale BOOLEAN&gt;0)</p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;">tcp_low_latency</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="66"><p style="text-align:center;">0</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" width="95"><p style="text-align:center;">0</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>允许</span> TCP/IP <span>栈适应在高吞吐量情况下低延时的情况；这个选项一般情形是的禁用。</span>(<span>但在构建</span>Beowulf <span>集群的时候</span>,<span>打开它很有帮助</span>)</p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" valign="top" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;">tcp_westwood</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="66"><p style="text-align:center;">0</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="95"><p style="text-align:center;">0</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>启用发送者端的拥塞控制算法，它可以维护对吞吐量的评估，并试图对带宽的整体利用情况进行优化；对于</span> WAN <span>通信来说应该启用这个选项。</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" valign="top" width="274"><p style="text-align:justify;"><strong><span style="font-family:cambria, serif;">tcp_bic</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="66"><p style="text-align:center;">0</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="95"><p style="text-align:center;">0</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>为快速长距离网络启用</span> Binary Increase Congestion<span>；这样可以更好地利用以</span> GB <span>速度进行操作的链接；对于</span> WAN <span>通信应该启用这个选项。</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" valign="top" width="274"><p style="text-align:justify;"><strong>ip_forward</strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="66"><p style="text-align:center;">0</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="95"><p style="text-align:center;"><span>－</span></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p>NAT<span>必须开启</span>IP<span>转发支持，把该值写</span>1</p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" valign="top" width="274"><p style="text-align:justify;"><strong><span style="color:#ff0000;">ip_local_port_range</span></strong><span style="color:#ff0000;">:</span><span style="color:#ff0000;">min</span><span style="color:#ff0000;">max</span></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="66"><p style="text-align:center;">32768</p><p style="text-align:center;">61000</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="95"><p style="text-align:center;">1024</p><p style="text-align:center;">65000</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span style="font-size:15px;line-height:115%;">表示用于向外连接的端口范围</span><span>，默认比较小，这个范围同样会间接用于</span>NAT<span>表规模。</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" valign="top" width="274"><p style="text-align:justify;"><a></a><a><strong><span style="color:#ff0000;">ip_conntrack_max</span></strong></a></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="66"><p style="text-align:center;">65535</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="95"><p style="text-align:center;">65535</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="455"><p><span>系统支持的最大</span>ipv4<span>连接数，默认</span>65536<span>（事实上这也是理论最大值），同时这个值和你的内存大小有关，如果内存</span>128M<span>，这个值最大</span>8192<span>，</span>1G<span>以上内存这个值都是默认</span>65536</p></td></tr></tbody></table>

<p><strong>所处目录/proc/sys/net/ipv4/netfilter/</strong><br>文件需要打开防火墙才会存在</p>
<table cellpadding="0" cellspacing="0"><tbody><tr><td style="border-color:#000000;border-width:1px;background-color:#d9d9d9;padding:0px 7px;" valign="top" width="274"><p style="text-align:center;"><span>名称</span></p></td><td style="border-top-color:#000000;border-right-color:#000000;border-bottom-color:#000000;border-top-width:1px;border-right-width:1px;border-bottom-width:1px;border-left-style:none;background-color:#d9d9d9;padding:0px 7px;" valign="top" width="66"><p style="text-align:center;"><span>默认值</span></p></td><td style="border-top-color:#000000;border-right-color:#000000;border-bottom-color:#000000;border-top-width:1px;border-right-width:1px;border-bottom-width:1px;border-left-style:none;background-color:#d9d9d9;padding:0px 7px;" valign="top" width="95"><p style="text-align:center;"><span>建议值</span></p></td><td style="border-top-color:#000000;border-right-color:#000000;border-bottom-color:#000000;border-top-width:1px;border-right-width:1px;border-bottom-width:1px;border-left-style:none;background-color:#d9d9d9;padding:0px 7px;" valign="top" width="300"><p><span>描述</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" valign="top" width="274"><p style="text-align:justify;"><strong><span style="color:#ff0000;">ip_conntrack_max</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="66"><p style="text-align:center;">65536</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="95"><p style="text-align:center;">65536</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="300"><p><span>系统支持的最大</span>ipv4<span>连接数，默认</span>65536<span>（事实上这也是理论最大值），同时这个值和你的内存大小有关，如果内存</span>128M<span>，这个值最大</span>8192<span>，</span>1G<span>以上内存这个值都是默认</span>65536,<span>这个值受</span>/proc/sys/net/ipv4/ip_conntrack_max<span>限制</span></p><p><br></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" valign="top" width="274"><p style="text-align:justify;"><a></a><a><strong><span style="color:#ff0000;">ip_conntrack_tcp_timeout_established</span></strong></a></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="66"><p style="text-align:center;">432000</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="95"><p style="text-align:center;">180</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="300"><p><span>已建立的</span>tcp<span>连接的超时时间，默认</span>432000<span>，也就是</span>5<span>天。</span><span style="font-size:13px;line-height:115%;">影响：这个值过大将导致一些可能已经不用的连接常驻于内存中，占用大量链接资源，从而可能导致</span><span style="font-size:13px;line-height:115%;">NAT ip_conntrack: table full</span><span style="font-size:13px;line-height:115%;">的问题</span><span style="font-size:13px;line-height:115%;">。</span><span style="font-size:13px;line-height:115%;">建议：对于</span><span style="font-size:13px;line-height:115%;">NAT</span><span style="font-size:13px;line-height:115%;">负载相对本机的</span><span style="font-size:13px;line-height:115%;"> NAT</span><span style="font-size:13px;line-height:115%;">表大小很紧张的时候，可能需要考虑缩小这个值，以尽早清除连接，保证有可用的连接资源；如果不紧张，不必修改</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" valign="top" width="274"><p style="text-align:justify;"><a></a><a><strong><span style="font-family:arial, sans-serif;">ip_conntrack_tcp_timeout_time_wait</span></strong></a></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="66"><p style="text-align:center;">120</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="95"><p style="text-align:center;">120</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="300"><p>time_wait<span>状态超时时间，超过该时间就清除该连接</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" valign="top" width="274"><p style="text-align:justify;"><strong><span style="font-family:arial, sans-serif;">ip_conntrack_tcp_timeout_close_wait</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="66"><p style="text-align:center;">60</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="95"><p style="text-align:center;">60</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="300"><p>close_wait<span>状态超时时间，超过该时间就清除该连接</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" valign="top" width="274"><p style="text-align:justify;"><strong><span style="font-family:arial, sans-serif;">ip_conntrack_tcp_timeout_fin_wait</span></strong></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="66"><p style="text-align:center;">120</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="95"><p style="text-align:center;">120</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="300"><p>fin_wait<span>状态超时时间，超过该时间就清除该连接</span></p></td></tr></tbody></table>

<p><strong>文件所处目录/proc/sys/net/core/</strong></p>
<table cellpadding="0" cellspacing="0"><tbody><tr><td style="border-color:#000000;border-width:1px;background-color:#d9d9d9;padding:0px 7px;" valign="top" width="274"><p><span>名称</span></p></td><td style="border-top-color:#000000;border-right-color:#000000;border-bottom-color:#000000;border-top-width:1px;border-right-width:1px;border-bottom-width:1px;border-left-style:none;background-color:#d9d9d9;padding:0px 7px;" valign="top" width="66"><p style="text-align:center;"><span>默认值</span></p></td><td style="border-top-color:#000000;border-right-color:#000000;border-bottom-color:#000000;border-top-width:1px;border-right-width:1px;border-bottom-width:1px;border-left-style:none;background-color:#d9d9d9;padding:0px 7px;" valign="top" width="95"><p style="text-align:center;"><span>建议值</span></p></td><td style="border-top-color:#000000;border-right-color:#000000;border-bottom-color:#000000;border-top-width:1px;border-right-width:1px;border-bottom-width:1px;border-left-style:none;background-color:#d9d9d9;padding:0px 7px;" valign="top" width="300"><p><span>描述</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" valign="top" width="274"><p style="margin-bottom:0;"><a></a><a><span style="font-size:16px;color:#ff0000;">netdev_max_backlog</span></a><span style="font-size:16px;color:#ff0000;"><br><br></span></p><p style="margin-bottom:0;"><br></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="66"><p style="text-align:center;">1024</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="95"><p style="text-align:center;">16384</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="300"><p><span style="font-size:16px;line-height:115%;">每个网络接口接收数据包的速率比内核处理这些包的速率快时，允许送到队列的数据包的最大数目，对重负载服务器而言，该值需要调高一点。</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" valign="top" width="274"><p style="margin-bottom:0;"><span style="font-size:16px;color:#ff0000;">somaxconn <br><br></span></p><p style="margin-bottom:0;"><br></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="66"><p style="text-align:center;">128</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="95"><p style="text-align:center;">16384</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="300"><p><span style="font-size:16px;line-height:115%;">用来限制监听(LISTEN)队列最大数据包的数量，超过这个数量就会导致链接超时或者触发重传机制。</span></p><p><span style="font-size:16px;line-height:115%;">web</span><span style="font-size:16px;line-height:115%;">应用中listen函数的backlog默认会给我们内核参数的net.core.somaxconn限制到128，而nginx定义的NGX_LISTEN_BACKLOG默认为511，所以有必要调整这个值。对繁忙的服务器,增加该值有助于网络性能</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" valign="top" width="274"><p style="margin-bottom:0;"><a></a><a><span style="font-size:16px;">wmem_default</span></a></p><p style="margin-bottom:0;"><br></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="66"><p style="text-align:center;">129024</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="95"><p style="text-align:center;">129024</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="300"><p><span style="font-size:13px;line-height:115%;">默认的发送窗口大小</span><span style="font-size:16px;line-height:115%;">（以字节为单位）</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" valign="top" width="274"><p style="margin-bottom:0;"><span style="font-size:16px;">rmem_default </span></p><p style="margin-bottom:0;"><br></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="66"><p style="text-align:center;">129024</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="95"><p style="text-align:center;">129024</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="300"><p><span style="font-size:13px;line-height:115%;">默认的接收窗口大小</span><span style="font-size:16px;line-height:115%;">（以字节为单位）</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" valign="top" width="274"><p style="margin-bottom:0;"><a></a><a></a><a><span style="font-size:16px;">rmem_max</span></a></p><p style="margin-bottom:0;"><br></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="66"><p style="text-align:center;">129024</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="95"><p style="text-align:center;"><span style="font-size:16px;line-height:115%;">873200</span></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="300"><p><span style="font-size:16px;line-height:115%;">最大的TCP数据接收缓冲</span></p></td></tr><tr><td style="border-right-color:#000000;border-bottom-color:#000000;border-left-color:#000000;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:none;padding:0px 7px;" valign="top" width="274"><p style="margin-bottom:0;"><span style="font-size:16px;">wmem_max </span></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="66"><p style="text-align:center;">129024</p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="95"><p style="text-align:center;"><span style="font-size:16px;line-height:115%;">873200</span></p></td><td style="border-top-style:none;border-left-style:none;border-bottom-color:#000000;border-bottom-width:1px;border-right-color:#000000;border-right-width:1px;padding:0px 7px;" valign="top" width="300"><p><span style="font-size:16px;line-height:115%;">最大的TCP数据发送缓冲</span></p></td></tr></tbody></table>

<h3 id="两种修改内核参数方法">两种修改内核参数方法</h3>
<ol>
<li><p>使用echo value方式直接追加到文件里如echo &quot;1&quot; &gt;/proc/sys/net/ipv4/tcp_syn_retries，但这种方法设备重启后又会恢复为默认值</p>
</li>
<li><p>把参数添加到/etc/sysctl.conf中，然后执行sysctl -p使参数生效，永久生效</p>
</li>
</ol>
<h3 id="内核生产环境优化参数">内核生产环境优化参数</h3>
<p>生产中常用的参数：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">net.ipv4.<span class="variable">tcp_syn_retries =</span> <span class="number">1</span></div><div class="line">net.ipv4.<span class="variable">tcp_synack_retries =</span> <span class="number">1</span></div><div class="line">net.ipv4.<span class="variable">tcp_keepalive_time =</span> <span class="number">600</span></div><div class="line">net.ipv4.<span class="variable">tcp_keepalive_probes =</span> <span class="number">3</span></div><div class="line">net.ipv4.<span class="variable">tcp_keepalive_intvl =</span><span class="number">15</span></div><div class="line">net.ipv4.<span class="variable">tcp_retries2 =</span> <span class="number">5</span></div><div class="line">net.ipv4.<span class="variable">tcp_fin_timeout =</span> <span class="number">2</span></div><div class="line">net.ipv4.<span class="variable">tcp_max_tw_buckets =</span> <span class="number">36000</span></div><div class="line">net.ipv4.<span class="variable">tcp_tw_recycle =</span> <span class="number">1</span></div><div class="line">net.ipv4.<span class="variable">tcp_tw_reuse =</span> <span class="number">1</span></div><div class="line">net.ipv4.<span class="variable">tcp_max_orphans =</span> <span class="number">32768</span></div><div class="line">net.ipv4.<span class="variable">tcp_syncookies =</span> <span class="number">1</span></div><div class="line">net.ipv4.<span class="variable">tcp_max_syn_backlog =</span> <span class="number">16384</span></div><div class="line">net.ipv4.<span class="variable">tcp_wmem =</span> <span class="number">8192</span> <span class="number">131072</span> <span class="number">16777216</span></div><div class="line">net.ipv4.<span class="variable">tcp_rmem =</span> <span class="number">32768</span> <span class="number">131072</span> <span class="number">16777216</span></div><div class="line">net.ipv4.<span class="variable">tcp_mem =</span> <span class="number">786432</span> <span class="number">1048576</span> <span class="number">1572864</span></div><div class="line">net.ipv4.<span class="variable">ip_local_port_range =</span> <span class="number">1024</span> <span class="number">65000</span></div><div class="line">net.core.<span class="variable">somaxconn =</span> <span class="number">16384</span></div><div class="line">net.core.<span class="variable">netdev_max_backlog =</span> <span class="number">16384</span></div></pre></td></tr></table></figure>

<p>不同的生产环境需要优化的参数基本差不多，只是值有相应的变化。具体优化值要参考应用场景，这儿所列只是常用优化参数，是否适合，可在上面查看该参数描述，理解后，再根据自己生产环境而设。</p>
<p>其它相关linux内核参数调整文章：<br>Linux内核参数优化<br><a href="http://flandycheng.blog.51cto.com/855176/476769" target="_blank" rel="external">http://flandycheng.blog.51cto.com/855176/476769</a></p>
<p>优化linux的内核参数来提高服务器并发处理能力<br><a href="http://www.ha97.com/4396.html" target="_blank" rel="external">http://www.ha97.com/4396.html</a></p>
<p>nginx做web服务器linux内核参数优化<br><a href="http://blog.csdn.net/force_eagle/article/details/6725243" target="_blank" rel="external">http://blog.csdn.net/force_eagle/article/details/6725243</a></p>
<hr>
<p><a href="http://www.sudops.com/linux-kernel-tcp-ip-sysctl-optimize.html" target="_blank" rel="external">sudops网站</a>提供的优化例子:<br>Linux下TCP/IP及内核参数优化有多种方式，参数配置得当可以大大提高系统的性能，也可以根据特定场景进行专门的优化，如TIME_WAIT过高，DDOS攻击等等。<br>如下配置是写在sysctl.conf中，可使用sysctl -p生效，文中附带了一些默认值和中文解释（从网上收集和翻译而来），确有些辛苦，转载请保留链接，谢谢～。<br>相关参数仅供参考，具体数值还需要根据机器性能，应用场景等实际情况来做更细微调整。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div></pre></td><td class="code"><pre><div class="line">net.core.netdev_max_backlog = <span class="number">400000</span></div><div class="line"><span class="preprocessor">#该参数决定了，网络设备接收数据包的速率比内核处理这些包的速率快时，允许送到队列的数据包的最大数目。</span></div><div class="line"> </div><div class="line">net.core.optmem_max = <span class="number">10000000</span></div><div class="line"><span class="preprocessor">#该参数指定了每个套接字所允许的最大缓冲区的大小</span></div><div class="line"> </div><div class="line">net.core.rmem_default = <span class="number">10000000</span></div><div class="line"><span class="preprocessor">#指定了接收套接字缓冲区大小的缺省值（以字节为单位）。</span></div><div class="line"> </div><div class="line">net.core.rmem_max = <span class="number">10000000</span></div><div class="line"><span class="preprocessor">#指定了接收套接字缓冲区大小的最大值（以字节为单位）。</span></div><div class="line"> </div><div class="line">net.core.somaxconn = <span class="number">100000</span></div><div class="line"><span class="preprocessor">#Linux kernel参数，表示socket监听的backlog(监听队列)上限</span></div><div class="line"> </div><div class="line">net.core.wmem_default = <span class="number">11059200</span></div><div class="line"><span class="preprocessor">#定义默认的发送窗口大小；对于更大的 BDP 来说，这个大小也应该更大。</span></div><div class="line"> </div><div class="line">net.core.wmem_max = <span class="number">11059200</span></div><div class="line"><span class="preprocessor">#定义发送窗口的最大大小；对于更大的 BDP 来说，这个大小也应该更大。</span></div><div class="line"> </div><div class="line">net.ipv4.conf.all.rp_filter = <span class="number">1</span></div><div class="line">net.ipv4.conf.<span class="keyword">default</span>.rp_filter = <span class="number">1</span></div><div class="line"><span class="preprocessor">#严谨模式 1 (推荐)</span></div><div class="line"><span class="preprocessor">#松散模式 0</span></div><div class="line"> </div><div class="line">net.ipv4.tcp_congestion_control = bic</div><div class="line"><span class="preprocessor">#默认推荐设置是 htcp</span></div><div class="line"> </div><div class="line">net.ipv4.tcp_window_scaling = <span class="number">0</span></div><div class="line"><span class="preprocessor">#关闭tcp_window_scaling</span></div><div class="line"><span class="preprocessor">#启用 RFC 1323 定义的 window scaling；要支持超过 64KB 的窗口，必须启用该值。</span></div><div class="line"> </div><div class="line">net.ipv4.tcp_ecn = <span class="number">0</span></div><div class="line"><span class="preprocessor">#把TCP的直接拥塞通告(tcp_ecn)关掉</span></div><div class="line"> </div><div class="line">net.ipv4.tcp_sack = <span class="number">1</span></div><div class="line"><span class="preprocessor">#关闭tcp_sack</span></div><div class="line"><span class="preprocessor">#启用有选择的应答（Selective Acknowledgment），</span></div><div class="line"><span class="preprocessor">#这可以通过有选择地应答乱序接收到的报文来提高性能（这样可以让发送者只发送丢失的报文段）；</span></div><div class="line"><span class="preprocessor">#（对于广域网通信来说）这个选项应该启用，但是这会增加对 CPU 的占用。</span></div><div class="line"> </div><div class="line">net.ipv4.tcp_max_tw_buckets = <span class="number">10000</span></div><div class="line"><span class="preprocessor">#表示系统同时保持TIME_WAIT套接字的最大数量</span></div><div class="line"> </div><div class="line">net.ipv4.tcp_max_syn_backlog = <span class="number">8192</span></div><div class="line"><span class="preprocessor">#表示SYN队列长度，默认1024，改成8192，可以容纳更多等待连接的网络连接数。</span></div><div class="line"> </div><div class="line">net.ipv4.tcp_syncookies = <span class="number">1</span></div><div class="line"><span class="preprocessor">#表示开启SYN Cookies。当出现SYN等待队列溢出时，启用cookies来处理，可防范少量SYN攻击，默认为0，表示关闭；</span></div><div class="line"> </div><div class="line">net.ipv4.tcp_timestamps = <span class="number">1</span></div><div class="line"><span class="preprocessor">#开启TCP时间戳</span></div><div class="line"><span class="preprocessor">#以一种比重发超时更精确的方法（请参阅 RFC 1323）来启用对 RTT 的计算；为了实现更好的性能应该启用这个选项。</span></div><div class="line"> </div><div class="line">net.ipv4.tcp_tw_reuse = <span class="number">1</span></div><div class="line"><span class="preprocessor">#表示开启重用。允许将TIME-WAIT sockets重新用于新的TCP连接，默认为0，表示关闭；</span></div><div class="line"> </div><div class="line">net.ipv4.tcp_tw_recycle = <span class="number">1</span></div><div class="line"><span class="preprocessor">#表示开启TCP连接中TIME-WAIT sockets的快速回收，默认为0，表示关闭。</span></div><div class="line"> </div><div class="line">net.ipv4.tcp_fin_timeout = <span class="number">10</span></div><div class="line"><span class="preprocessor">#表示如果套接字由本端要求关闭，这个参数决定了它保持在FIN-WAIT-2状态的时间。</span></div><div class="line"> </div><div class="line">net.ipv4.tcp_keepalive_time = <span class="number">1800</span></div><div class="line"><span class="preprocessor">#表示当keepalive起用的时候，TCP发送keepalive消息的频度。缺省是2小时，改为30分钟。</span></div><div class="line"> </div><div class="line">net.ipv4.tcp_keepalive_probes = <span class="number">3</span></div><div class="line"><span class="preprocessor">#如果对方不予应答，探测包的发送次数</span></div><div class="line"> </div><div class="line">net.ipv4.tcp_keepalive_intvl = <span class="number">15</span></div><div class="line"><span class="preprocessor">#keepalive探测包的发送间隔</span></div><div class="line"> </div><div class="line">net.ipv4.tcp_mem</div><div class="line"><span class="preprocessor">#确定 TCP 栈应该如何反映内存使用；每个值的单位都是内存页（通常是 4KB）。</span></div><div class="line"><span class="preprocessor">#第一个值是内存使用的下限。</span></div><div class="line"><span class="preprocessor">#第二个值是内存压力模式开始对缓冲区使用应用压力的上限。</span></div><div class="line"><span class="preprocessor">#第三个值是内存上限。在这个层次上可以将报文丢弃，从而减少对内存的使用。对于较大的 BDP 可以增大这些值（但是要记住，其单位是内存页，而不是字节）。</span></div><div class="line"> </div><div class="line">net.ipv4.tcp_rmem</div><div class="line"><span class="preprocessor">#与 tcp_wmem 类似，不过它表示的是为自动调优所使用的接收缓冲区的值。</span></div><div class="line"> </div><div class="line">net.ipv4.tcp_wmem = <span class="number">30000000</span> <span class="number">30000000</span> <span class="number">30000000</span></div><div class="line"><span class="preprocessor">#为自动调优定义每个 socket 使用的内存。</span></div><div class="line"><span class="preprocessor">#第一个值是为 socket 的发送缓冲区分配的最少字节数。</span></div><div class="line"><span class="preprocessor">#第二个值是默认值（该值会被 wmem_default 覆盖），缓冲区在系统负载不重的情况下可以增长到这个值。</span></div><div class="line"><span class="preprocessor">#第三个值是发送缓冲区空间的最大字节数（该值会被 wmem_max 覆盖）。</span></div><div class="line"> </div><div class="line">net.ipv4.ip_local_port_range = <span class="number">1024</span> <span class="number">65000</span></div><div class="line"><span class="preprocessor">#表示用于向外连接的端口范围。缺省情况下很小：32768到61000，改为1024到65000。</span></div><div class="line"> </div><div class="line">net.ipv4.netfilter.ip_conntrack_max=<span class="number">204800</span></div><div class="line"><span class="preprocessor">#设置系统对最大跟踪的TCP连接数的限制</span></div><div class="line"> </div><div class="line">net.ipv4.tcp_slow_start_after_idle = <span class="number">0</span></div><div class="line"><span class="preprocessor">#关闭tcp的连接传输的慢启动，即先休止一段时间，再初始化拥塞窗口。</span></div><div class="line"> </div><div class="line">net.ipv4.route.gc_timeout = <span class="number">100</span></div><div class="line"><span class="preprocessor">#路由缓存刷新频率，当一个路由失败后多长时间跳到另一个路由，默认是300。</span></div><div class="line"> </div><div class="line">net.ipv4.tcp_syn_retries = <span class="number">1</span></div><div class="line"><span class="preprocessor">#在内核放弃建立连接之前发送SYN包的数量。</span></div><div class="line"> </div><div class="line">net.ipv4.icmp_echo_ignore_broadcasts = <span class="number">1</span></div><div class="line"><span class="preprocessor"># 避免放大攻击</span></div><div class="line"> </div><div class="line">net.ipv4.icmp_ignore_bogus_error_responses = <span class="number">1</span></div><div class="line"><span class="preprocessor"># 开启恶意icmp错误消息保护</span></div><div class="line"> </div><div class="line">net.inet.udp.checksum=<span class="number">1</span></div><div class="line"><span class="preprocessor">#防止不正确的udp包的攻击</span></div><div class="line"> </div><div class="line">net.ipv4.conf.<span class="keyword">default</span>.accept_source_route = <span class="number">0</span></div><div class="line"><span class="preprocessor">#是否接受含有源路由信息的ip包。参数值为布尔值，1表示接受，0表示不接受。</span></div><div class="line"><span class="preprocessor">#在充当网关的linux主机上缺省值为1，在一般的linux主机上缺省值为0。</span></div><div class="line"><span class="preprocessor">#从安全性角度出发，建议你关闭该功能。</span></div></pre></td></tr></table></figure>

<hr>
<p><a href="http://www.cnblogs.com/fczjuever/archive/2013/04/17/3026694.html" target="_blank" rel="external">最初的幸福ever</a>也提供了一些参数的说明。</p>
<p><strong>/proc/sys/net目录</strong><br>所有的TCP/IP参数都位于/proc/sys/net目录下（请注意，对/proc/sys/net目录下内容的修改都是临时的，任何修改在系统重启后都会丢失），例如下面这些重要的参数：</p>
<table cellpadding="0" cellspacing="0"><tbody><tr><td width="314"><p align="center"><span style="font-size: 13px;"><strong>参数（路径</strong><strong>+</strong><strong>文件）</strong></span></p></td><td width="449"><p align="center"><span style="font-size: 13px;"><strong>描述</strong></span></p></td><td width="212"><p align="center"><span style="font-size: 13px;"><strong>默认值</strong></span></p></td><td width="225"><p align="center"><span style="font-size: 13px;"><strong>优化值</strong></span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/core/rmem_default</span></p></td><td width="449"><p align="left"><span style="font-size: 13px;">默认的TCP数据接收窗口大小（字节）。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">229376</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">256960</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/core/rmem_max</span></p></td><td width="449"><p><span style="font-size: 13px;">最大的TCP数据接收窗口（字节）。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">131071</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">513920</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/core/wmem_default</span></p></td><td width="449"><p><span style="font-size: 13px;">默认的TCP数据发送窗口大小（字节）。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">229376</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">256960</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/core/wmem_max</span></p></td><td width="449"><p><span style="font-size: 13px;">最大的TCP数据发送窗口（字节）。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">131071</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">513920</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/core/netdev_max_backlog</span></p></td><td width="449"><p><span style="font-size: 13px;">在每个网络接口接收数据包的速率比内核处理这些包的速率快时，允许送到队列的数据包的最大数目。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">1000</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">2000</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/core/somaxconn</span></p></td><td width="449"><p><span style="font-size: 13px;">定义了系统中每一个端口最大的监听队列的长度，这是个全局的参数。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">128</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">2048</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/core/optmem_max</span></p></td><td width="449"><p><span style="font-size: 13px;">表示每个套接字所允许的最大缓冲区的大小。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">20480</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">81920</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/ipv4/tcp_mem</span></p></td><td width="449"><p><span style="font-size: 13px;">确定TCP栈应该如何反映内存使用，每个值的单位都是内存页（通常是4KB）。第一个值是内存使用的下限；第二个值是内存压力模式开始对缓冲区使用应用压力的上限；第三个值是内存使用的上限。在这个层次上可以将报文丢弃，从而减少对内存的使用。对于较大的BDP可以增大这些值（注意，其单位是内存页而不是字节）。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">94011&nbsp; 125351&nbsp; 188022</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">131072&nbsp; 262144&nbsp; 524288</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/ipv4/tcp_rmem</span></p></td><td width="449"><p><span style="font-size: 13px;">为自动调优定义socket使用的内存。第一个值是为socket接收缓冲区分配的最少字节数；第二个值是默认值（该值会被rmem_default覆盖），缓冲区在系统负载不重的情况下可以增长到这个值；第三个值是接收缓冲区空间的最大字节数（该值会被rmem_max覆盖）。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">4096&nbsp; 87380&nbsp; 4011232</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">8760&nbsp; 256960&nbsp; 4088000</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/ipv4/tcp_wmem</span></p></td><td width="449"><p><span style="font-size: 13px;">为自动调优定义socket使用的内存。第一个值是为socket发送缓冲区分配的最少字节数；第二个值是默认值（该值会被wmem_default覆盖），缓冲区在系统负载不重的情况下可以增长到这个值；第三个值是发送缓冲区空间的最大字节数（该值会被wmem_max覆盖）。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">4096&nbsp; 16384&nbsp; 4011232</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">8760&nbsp; 256960&nbsp; 4088000</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/ipv4/tcp_keepalive_time</span></p></td><td width="449"><p><span style="font-size: 13px;">TCP发送keepalive探测消息的间隔时间（秒），用于确认TCP连接是否有效。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">7200</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">1800</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/ipv4/tcp_keepalive_intvl</span></p></td><td width="449"><p><span style="font-size: 13px;">探测消息未获得响应时，重发该消息的间隔时间（秒）。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">75</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">30</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/ipv4/tcp_keepalive_probes</span></p></td><td width="449"><p><span style="font-size: 13px;">在认定TCP连接失效之前，最多发送多少个keepalive探测消息。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">9</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">3</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/ipv4/tcp_sack</span></p></td><td width="449"><p><span style="font-size: 13px;">启用有选择的应答（1表示启用），通过有选择地应答乱序接收到的报文来提高性能，让发送者只发送丢失的报文段，（对于广域网通信来说）这个选项应该启用，但是会增加对CPU的占用。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">1</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">1</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/ipv4/tcp_fack</span></p></td><td width="449"><p><span style="font-size: 13px;">启用转发应答，可以进行有选择应答（SACK）从而减少拥塞情况的发生，这个选项也应该启用。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">1</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">1</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/ipv4/tcp_timestamps</span></p></td><td width="449"><p><span style="font-size: 13px;">TCP时间戳（会在TCP包头增加12个字节），以一种比重发超时更精确的方法（参考RFC 1323）来启用对RTT 的计算，为实现更好的性能应该启用这个选项。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">1</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">1</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/ipv4/tcp_window_scaling</span></p></td><td width="449"><p><span style="font-size: 13px;">启用RFC 1323定义的window scaling，要支持超过64KB的TCP窗口，必须启用该值（1表示启用），TCP窗口最大至1GB，TCP连接双方都启用时才生效。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">1</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">1</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/ipv4/tcp_syncookies</span></p></td><td width="449"><p><span style="font-size: 13px;">表示是否打开TCP同步标签（syncookie），内核必须打开了CONFIG_SYN_COOKIES项进行编译，同步标签可以防止一个套接字在有过多试图连接到达时引起过载。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">1</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">1</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/ipv4/tcp_tw_reuse</span></p></td><td width="449"><p><span style="font-size: 13px;">表示是否允许将处于TIME-WAIT状态的socket（TIME-WAIT的端口）用于新的TCP连接 。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">0</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">1</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/ipv4/tcp_tw_recycle</span></p></td><td width="449"><p><span style="font-size: 13px;">能够更快地回收TIME-WAIT套接字。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">0</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">1</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/ipv4/tcp_fin_timeout</span></p></td><td width="449"><p><span style="font-size: 13px;">对于本端断开的socket连接，TCP保持在FIN-WAIT-2状态的时间（秒）。对方可能会断开连接或一直不结束连接或不可预料的进程死亡。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">60</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">30</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/ipv4/ip_local_port_range</span></p></td><td width="449"><p><span style="font-size: 13px;">表示TCP/UDP协议允许使用的本地端口号</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">32768&nbsp; 61000</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">1024&nbsp; 65000</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/ipv4/tcp_max_syn_backlog</span></p></td><td width="449"><p><span style="font-size: 13px;">对于还未获得对方确认的连接请求，可保存在队列中的最大数目。如果服务器经常出现过载，可以尝试增加这个数字。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">2048</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">2048</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/ipv4/tcp_low_latency</span></p></td><td width="449"><p><span style="font-size: 13px;">允许TCP/IP栈适应在高吞吐量情况下低延时的情况，这个选项应该禁用。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">0</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">&nbsp;</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/ipv4/tcp_westwood</span></p></td><td width="449"><p><span style="font-size: 13px;">启用发送者端的拥塞控制算法，它可以维护对吞吐量的评估，并试图对带宽的整体利用情况进行优化，对于WAN 通信来说应该启用这个选项。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">0</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">&nbsp;</span></p></td></tr><tr><td width="314"><p><span style="font-size: 13px;">/proc/sys/net/ipv4/tcp_bic</span></p></td><td width="449"><p><span style="font-size: 13px;">为快速长距离网络启用Binary Increase Congestion，这样可以更好地利用以GB速度进行操作的链接，对于WAN通信应该启用这个选项。</span></p></td><td width="212"><p align="center"><span style="font-size: 13px;">1</span></p></td><td width="225"><p align="center"><span style="font-size: 13px;">&nbsp;</span></p></td></tr></tbody></table>

      
    </div>
    <footer class="article-footer">
	
<div class="bdsharebuttonbox"><a title="分享到新浪微博" class="bds_tsina" href="#" data-cmd="tsina"></a><a title="分享到微信" class="bds_weixin" href="#" data-cmd="weixin"></a><a title="分享到QQ空间" class="bds_qzone" href="#" data-cmd="qzone"></a><a title="分享到印象笔记" class="bds_evernotecn" href="#" data-cmd="evernotecn"></a><a title="分享到有道云笔记" class="bds_youdao" href="#" data-cmd="youdao"></a><a title="分享到百度云收藏" class="bds_bdysc" href="#" data-cmd="bdysc"></a><a class="bds_more" href="#" data-cmd="more"></a></div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
      

	  

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TCP-IP/">TCP/IP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sysctl/">sysctl</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2014/09/18/one-issue-caused-by-linux-retransmission/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Linux重传机制对测试结果的一个影响
        
      </div>
    </a>
  
  
    <a href="/2014/09/17/what-means-apachebench-test-result/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">ApacheBench 测试结果的解释</div>
    </a>
  
</nav>

  
</article>


<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<section id="comments">
  <div id="gitalk-container"></div>  
  <script type="text/javascript">
    var gitalkOpts = {
    id: '2014/09/18/linux-tcpip-tuning/',
    owner: 'smallnest',
    repo: 'gitalk',
    title: 'Linux TCP/IP 协议栈调优',
    body: 'http://colobu.com/2014/09/18/linux-tcpip-tuning/',
    clientID: 'bc02724130ed5b7ee275',
    clientSecret: '68cb0bae2f93a8b88b09e0eb9b08c844b06a9047',
    admin: ['smallnest'],
    distractionFreeMode: false
  };

  const gitalk = new Gitalk(gitalkOpts)
  gitalk.render('gitalk-container')
	</script>
  <noscript> 为正常使用评论功能请激活JavaScript</noscript>
</section>  


</section>
        
          <aside id="sidebar">
  
      <div class="widget-wrap">
    <h3 class="widget-title">原创图书</h3>
    <div class="widget">
      <a href="/ScalaCollectionsCookbook/">
        <img width="100%" src="/ScalaCollectionsCookbook/scala_collections_cookbook.jpg">
        <img width="100%" src="/ScalaCollectionsCookbook/scala_collections_cookbook_tw.png">
      </a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/DOTNET/">DOTNET</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Go/">Go</a><span class="category-list-count">98</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">62</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Scala/">Scala</a><span class="category-list-count">18</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端开发/">前端开发</a><span class="category-list-count">18</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/区块链/">区块链</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/大数据/">大数据</a><span class="category-list-count">59</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工具/">工具</a><span class="category-list-count">24</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据库/">数据库</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/架构/">架构</a><span class="category-list-count">24</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/算法/">算法</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/管理/">管理</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/网络编程/">网络编程</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/读书笔记/">读书笔记</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/运维/">运维</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/高并发编程/">高并发编程</a><span class="category-list-count">20</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Android/" style="font-size: 16.67px;">Android</a><a href="/tags/ApacheBench/" style="font-size: 11.67px;">ApacheBench</a><a href="/tags/Bower/" style="font-size: 10.00px;">Bower</a><a href="/tags/C/" style="font-size: 10.00px;">C#</a><a href="/tags/CDN/" style="font-size: 10.00px;">CDN</a><a href="/tags/CQRS/" style="font-size: 10.00px;">CQRS</a><a href="/tags/CRC/" style="font-size: 10.00px;">CRC</a><a href="/tags/CSS/" style="font-size: 11.67px;">CSS</a><a href="/tags/CompletableFuture/" style="font-size: 10.00px;">CompletableFuture</a><a href="/tags/Comsat/" style="font-size: 10.00px;">Comsat</a><a href="/tags/Curator/" style="font-size: 20.00px;">Curator</a><a href="/tags/DSL/" style="font-size: 10.00px;">DSL</a><a href="/tags/Disruptor/" style="font-size: 10.00px;">Disruptor</a><a href="/tags/Docker/" style="font-size: 11.67px;">Docker</a><a href="/tags/Ember/" style="font-size: 11.67px;">Ember</a><a href="/tags/FastJson/" style="font-size: 10.00px;">FastJson</a><a href="/tags/Fiber/" style="font-size: 10.00px;">Fiber</a><a href="/tags/GAE/" style="font-size: 10.00px;">GAE</a><a href="/tags/GC/" style="font-size: 13.33px;">GC</a><a href="/tags/Gnuplot/" style="font-size: 10.00px;">Gnuplot</a><a href="/tags/Go/" style="font-size: 13.33px;">Go</a><a href="/tags/Gradle/" style="font-size: 10.00px;">Gradle</a><a href="/tags/Grunt/" style="font-size: 10.00px;">Grunt</a><a href="/tags/Gulp/" style="font-size: 10.00px;">Gulp</a><a href="/tags/Hadoop/" style="font-size: 10.00px;">Hadoop</a><a href="/tags/Hazelcast/" style="font-size: 10.00px;">Hazelcast</a><a href="/tags/Ignite/" style="font-size: 10.00px;">Ignite</a><a href="/tags/JVM/" style="font-size: 10.00px;">JVM</a><a href="/tags/Java/" style="font-size: 18.33px;">Java</a><a href="/tags/Kafka/" style="font-size: 20.00px;">Kafka</a><a href="/tags/Lambda/" style="font-size: 15.00px;">Lambda</a><a href="/tags/Linux/" style="font-size: 13.33px;">Linux</a><a href="/tags/LongAdder/" style="font-size: 10.00px;">LongAdder</a><a href="/tags/MathJax/" style="font-size: 10.00px;">MathJax</a><a href="/tags/Maven/" style="font-size: 11.67px;">Maven</a><a href="/tags/Memcached/" style="font-size: 10.00px;">Memcached</a><a href="/tags/Metrics/" style="font-size: 10.00px;">Metrics</a><a href="/tags/Mongo/" style="font-size: 13.33px;">Mongo</a><a href="/tags/Netty/" style="font-size: 16.67px;">Netty</a><a href="/tags/Nginx/" style="font-size: 10.00px;">Nginx</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">July 2015</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">June 2015</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">May 2015</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">April 2015</a><span class="archive-list-count">15</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">March 2015</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">February 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">January 2015</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a><span class="archive-list-count">28</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">November 2014</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">October 2014</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">September 2014</a><span class="archive-list-count">28</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">August 2014</a><span class="archive-list-count">19</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/07/">July 2014</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">近期文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/03/26/channel-patterns/">Go Channel 应用模式</a>
          </li>
        
          <li>
            <a href="/2018/03/26/distributed-hash-table/">DHT 分布式哈希表</a>
          </li>
        
          <li>
            <a href="/2018/03/12/Concurrency-Utilities-Enhancements-in-Java-8-Java-9/">Java8 和 Java 9中并发工具的改变</a>
          </li>
        
          <li>
            <a href="/2018/03/12/20-Examples-of-Using-Java’s-CompletableFuture/">[译]20个使用 Java CompletableFuture的例子</a>
          </li>
        
          <li>
            <a href="/2018/03/12/Debugging-Go-Code-with-LLDB/">[译]使用 LLDB 调试 Go 程序</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">友情链接</h3>
    <div class="widget">
      <ul>
        
          <li>
			 
            <a href="http://old.colobu.com" target="_blank">以前的博客</a>
			
          </li>
        
          <li>
			 
			&nbsp;
			
          </li>
        
          <li>
			 
            <a href="http://stackshare.io" target="_blank">技术栈</a>
			
          </li>
        
          <li>
			 
			&nbsp;
			
          </li>
        
          <li>
			 
            <a href="http://weekly.manong.io/issues/" target="_blank">码农周刊</a>
			
          </li>
        
          <li>
			 
            <a href="http://www.tuicool.com/mags" target="_blank">编程狂人周刊</a>
			
          </li>
        
          <li>
			 
            <a href="http://www.importnew.com/" target="_blank">importnew</a>
			
          </li>
        
          <li>
			 
            <a href="http://ifeve.com/" target="_blank">并发编程网</a>
			
          </li>
        
          <li>
			 
			&nbsp;
			
          </li>
        
          <li>
			 
            <a href="http://github.com" target="_blank">github</a>
			
          </li>
        
          <li>
			 
            <a href="http://stackoverflow.com/" target="_blank">stackoverflow</a>
			
          </li>
        
          <li>
			 
            <a href="http://www.javacodegeeks.com/" target="_blank">javacodegeeks</a>
			
          </li>
        
          <li>
			 
            <a href="http://www.infoq.com/" target="_blank">infoq</a>
			
          </li>
        
          <li>
			 
            <a href="http://www.dzone.com/links/index.html" target="_blank">dzone</a>
			
          </li>
        
          <li>
			 
            <a href="https://oj.leetcode.com/problems/" target="_blank">leetcode</a>
			
          </li>
        
          <li>
			 
            <a href="http://tutorials.jenkov.com" target="_blank">jenkov</a>
			
          </li>
        
      </ul>
    </div>
  </div>

  
      

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 smallnest<br>
	  Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="https://github.com/smallnest" class="mobile-nav-link">github</a>
  
    <a href="/goasm" class="mobile-nav-link">Go汇编示例</a>
  
    <a href="/ScalaCollectionsCookbook" class="mobile-nav-link">Scala集合技术手册</a>
  
    <a href="/techreview" class="mobile-nav-link">技术快报</a>
  
    <a href="/about" class="mobile-nav-link">关于</a>
  
</nav>
    
<script src="//cdn.staticfile.org/jquery/1.11.1/jquery.min.js"></script>
<script src="//cdn.bootcss.com/jquery.lazyload/1.9.1/jquery.lazyload.min.js"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js"></script>


<script src="/js/script.js" type="text/javascript"></script>

<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
  });
  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>
<script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.6.0-beta.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<div id="totop" style="position:fixed;bottom:150px;right:10px;cursor: pointer;z-index: 2000;">
	<a title="返回顶部"><img src="/images/scrollup.png"/></a>
</div>
<script src="/js/totop.js" type="text/javascript"></script>



<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-142561-4']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e085d87993250aab11f3e0c15f1c2785";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


  </div>
</body>
</html>