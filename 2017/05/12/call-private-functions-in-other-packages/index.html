<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>突破限制,访问其它Go package中的私有函数 | 鸟窝</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="熟悉C++、Java、C#等面向对象的编程语言的同学，在学习Go语言的过程中，经常会被访问权限所困扰，逐渐才能了解这样一个事实：
 Go语言通过identifier的首字母是否大写来决定它是否可以被其它package所访问。
正式的Go语言规范是这么规定的：

An identifier may be exported to permit access to it from another pac">
<meta property="og:type" content="article">
<meta property="og:title" content="突破限制,访问其它Go package中的私有函数">
<meta property="og:url" content="http://colobu.com/2017/05/12/call-private-functions-in-other-packages/">
<meta property="og:site_name" content="鸟窝">
<meta property="og:description" content="熟悉C++、Java、C#等面向对象的编程语言的同学，在学习Go语言的过程中，经常会被访问权限所困扰，逐渐才能了解这样一个事实：
 Go语言通过identifier的首字母是否大写来决定它是否可以被其它package所访问。
正式的Go语言规范是这么规定的：

An identifier may be exported to permit access to it from another pac">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="突破限制,访问其它Go package中的私有函数">
<meta name="twitter:description" content="熟悉C++、Java、C#等面向对象的编程语言的同学，在学习Go语言的过程中，经常会被访问权限所困扰，逐渐才能了解这样一个事实：
 Go语言通过identifier的首字母是否大写来决定它是否可以被其它package所访问。
正式的Go语言规范是这么规定的：

An identifier may be exported to permit access to it from another pac">

  
    <link rel="alternative" href="/atom.xml" title="鸟窝" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">

  <link href="//cdn.staticfile.org/font-awesome/4.2.0/css/font-awesome.css" rel="stylesheet">
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/css/jquery.fancybox.min.css" media="screen" type="text/css">
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//cdn.staticfile.org/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->

  <script type="text/javascript">
	//visit my previous blog: http://old.colobu.com just like this http://colobu.com/?=123456
    var blog_url = location.href.toString();
	if (blog_url.indexOf("http://colobu.com/?p=") >= 0) {
		blog_url = blog_url.replace("colobu.com", "old.colobu.com");
		window.location.assign(blog_url);
	} else if (blog_url.indexOf("http://smallnest.gitcafe.com") >= 0) {
		blog_url = blog_url.replace("smallnest.gitcafe.com", "colobu.com");
		window.location.assign(blog_url);
	}  else if (blog_url.indexOf("http://smallnest.gitcafe.io") >= 0) {
		blog_url = blog_url.replace("smallnest.gitcafe.io", "colobu.com");
		window.location.assign(blog_url);
	}
</script>
  <style type="text/css">
    .news-essay
    {
      display: inline !important;
    }
    .hot-news
    {
      text-align: left !important;
    }
  </style>
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap" class="animated bounceInLeft">
        <a href="/" id="logo">鸟窝</a>
      </h1>
      
        <h2 id="subtitle-wrap" class="animated bounceInLeft">
          <a href="/" id="subtitle">大道至简 Simplicity is the ultimate form of sophistication</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/"><i class="fa fa-home">&nbsp;</i>首页</a>
        
          <a class="main-nav-link" href="/archives"><i class="fa fa-folder-o">&nbsp;</i>归档</a>
        
          <a class="main-nav-link" href="https://github.com/smallnest"><i class="fa fa-github">&nbsp;</i>github</a>
        
          <a class="main-nav-link" href="/goasm"><i class="fa fa-language">&nbsp;</i>Go汇编示例</a>
        
          <a class="main-nav-link" href="/ScalaCollectionsCookbook"><i class="fa fa-book">&nbsp;</i>Scala集合技术手册</a>
        
          <a class="main-nav-link" href="/techreview"><i class="fa fa-newspaper-o">&nbsp;</i>技术快报</a>
        
          <a class="main-nav-link" href="/about"><i class="fa fa-lemon-o">&nbsp;</i>关于</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="http://www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
          <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="Search">
          <input type="submit" value="" class="search-form-submit">
          <input name=tn type=hidden value="bds">
          <input name=cl type=hidden value="3">
          <input name=ct type=hidden value="2097152">
          <input type="hidden" name="si" value="colobu.com">
        </form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-call-private-functions-in-other-packages" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/05/12/call-private-functions-in-other-packages/" class="article-date">
  <time datetime="2017-05-12T07:09:50.000Z" itemprop="datePublished">2017年05月12日</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Go/">Go</a>
  </div>

	
  <div class="article-author"> by smallnest</div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      突破限制,访问其它Go package中的私有函数
	  
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
	  
	    <h1 id="expanderHead" style="cursor:pointer;">
		目录 <span id="expanderSign">[−]</span>
		</h1>
	    <div id="article-entry-toc" data-role="collapsible" class="article-entry-toc">
		  <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#将exported类型变为其它package不可访问"><span class="toc-text">将exported类型变为其它package不可访问</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#访问其它package中的私有方法"><span class="toc-text">访问其它package中的私有方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#访问其它package中的struct_私有字段"><span class="toc-text">访问其它package中的struct 私有字段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#更hack的方法"><span class="toc-text">更hack的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#参考文档"><span class="toc-text">参考文档</span></a></li></ol>
	    </div>
	  
	  
      
        <p>熟悉C++、Java、C#等面向对象的编程语言的同学，在学习Go语言的过程中，经常会被访问权限所困扰，逐渐才能了解这样一个事实：</p>
<p><strong> Go语言通过<code>identifier</code>的首字母是否大写来决定它是否可以被其它package所访问。</strong></p>
<p>正式的Go语言规范是这么规定的：</p>
<blockquote>
<p>An identifier may be exported to permit access to it from another package. An identifier is exported if both:</p>
<p>the first character of the identifier&#39;s name is a Unicode upper case letter (Unicode class &quot;Lu&quot;); and<br>the identifier is declared in the package block or it is a field name or method name.</p>
<p>All other identifiers are not exported.</p>
</blockquote>
<p>这个Go语言规范定义的访问权限控制方法。</p>
<a id="more"></a>
<p>但是有没有办法突破这个限制呢？</p>
<p>突破可以从两个方向来讨论： 将<code>exported</code>类型变为其它package不可访问；将<code>unexported</code>的类型变为其它package可访问。</p>
<h3 id="将exported类型变为其它package不可访问">将<code>exported</code>类型变为其它package不可访问</h3>
<p>至少有一个办法可以将package中 exported的函数、类型变为其它package不可访问， 那就是定义一个<code>internal</code> package,将这些package放在<code>internal</code> package之下。</p>
<p>Go语言本身没有这个限制，这是通过<code>go</code>命令实现的。最早这个特性是在 <a href="https://golang.org/doc/go1.4#internalpackages" target="_blank" rel="external">go 1.4</a>版本中引入的，相关的细节可以查看文档： <a href="https://docs.google.com/document/d/1e8kOo3r51b2BWtTs_1uADIA5djfXhPT36s6eHVRIvaU/edit" target="_blank" rel="external">design document</a></p>
<p>这个规则是这样的：</p>
<blockquote>
<p>An import of a path containing the element “internal” is disallowed if the importing code is outside the tree rooted at the parent of the “internal” directory.</p>
</blockquote>
<p>也就是<code>internal</code>包下的 exported 类型只能由internal所在的package (internal的parent)为root的package所访问。</p>
<p>举例来说：</p>
<ul>
<li><code>/a/b/c/internal/d/e/f</code> 可以被<code>/a/b/c</code> import， 不能被 <code>/a/b/g</code> import.</li>
<li><code>$GOROOT/src/pkg/internal/xxx</code>只可以被标准库import ($GOROOT/src/).</li>
<li><code>$GOROOT/src/pkg/net/http/internal</code> 只可以被 <code>net/http</code> 和 <code>net/http/*</code> import.</li>
<li><code>$GOPATH/src/mypkg/internal/foo</code> 只能被<code>$GOPATH/src/mypkg</code> import.</li>
</ul>
<h3 id="访问其它package中的私有方法">访问其它package中的私有方法</h3>
<p>如果你查看 Go 标准库的的代码， 比如 <a href="https://github.com/golang/go/blob/master/src/time/sleep.go" target="_blank" rel="external">time/sleep.go</a> 文件， 你会发现一些奇怪的函数， 如 <code>Sleep</code>:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">func</span> Sleep(d Duration)</div></pre></td></tr></table></figure>

<p>这个函数我们经常会用到， 也就是<code>time.Sleep</code>函数，但是这个函数并没有函数体，而且同样的目录下也没有汇编语言的代码实现，那么，这个函数在哪里定义的？</p>
<p>依照<a href="https://golang.org/ref/spec#Function_declarations" target="_blank" rel="external">规范</a>，一个只有函数声明的函数是在Go的外部实现的，我们称之为<code>external function</code>。</p>
<p>实际上，这个&quot;外部函数&quot;也是在Go标准库中实现的，它是 runtime中的一个 unexported的函数:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//go:linkname timeSleep time.Sleep</span></div><div class="line"><span class="keyword">func</span> timeSleep(ns <span class="typename">int64</span>) {</div><div class="line">	<span class="keyword">if</span> ns &lt;=<span class="number"> 0</span> {</div><div class="line">		<span class="keyword">return</span></div><div class="line">	}</div><div class="line"></div><div class="line">	t := getg().timer</div><div class="line">	<span class="keyword">if</span> t == <span class="constant">nil</span> {</div><div class="line">		t = <span class="built_in">new</span>(timer)</div><div class="line">		getg().timer = t</div><div class="line">	}</div><div class="line"></div><div class="line">    ......</div><div class="line"></div><div class="line">}</div></pre></td></tr></table></figure>

<p>事实上，runtime为其它 package中定义了很多的函数，比如<code>sync</code>、<code>net</code>中的一些函数，你可以通过命令<code>grep linkname /usr/local/go/src/runtime/*.go</code>查找这些函数。</p>
<p>我们会有两个疑问：一是为什么这些函数要定义在 runtime package中，而是这个机制到底是怎么实现的？</p>
<p>将相关的函数定义在<code>runtime</code>中的好处是， 它们可以访问 runtime package中 unexported的类型， 比如<code>getp</code>函数等，相当于往 runtime package打入一个&quot;叛徒&quot;,通过&quot;叛徒&quot;可以访问 runtime package 的私有对象。同时，这些&quot;叛徒&quot;函数尽管被声明为unexported,还是可以在其它package中访问。</p>
<p>第二个问题，其实是Go的<code>go:linkname</code>这个指令发挥的作用,它的格式如下：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//go:linkname localname importpath.name</span></div></pre></td></tr></table></figure>

<p><a href="https://golang.org/cmd/compile/" target="_blank" rel="external">Go文档</a>说明了这个指令的作用：</p>
<blockquote>
<p>The //go:linkname directive instructs the compiler to use “importpath.name” as the object file symbol name for the variable or function declared as “localname” in the source code. Because this directive can subvert the type system and package modularity, it is only enabled in files that have imported &quot;unsafe&quot;.</p>
</blockquote>
<p>这个指令告诉编译器为函数或者变量<code>localname</code>使用<code>importpath.name</code>作为目标文件的符号名。因为这个指令破坏了类型系统和包的模块化，所以它只能在 import &quot;unsafe&quot; 的情况下才能使用。</p>
<p><code>importpath.name</code>可以是这种格式:<code>a/b/c/d/apkg.foo</code>，这样在package <code>a/b/c/d/apkg</code>中就可以使用这个函数<code>foo</code>了。</p>
<p>举个例子,假设我们的package布局如下:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">├── <span class="keyword">a</span></div><div class="line">│   └── <span class="keyword">a</span>.<span class="keyword">go</span></div><div class="line">├── <span class="keyword">b</span></div><div class="line">│   ├── <span class="keyword">b</span>.<span class="keyword">go</span></div><div class="line">│   └── internal.<span class="keyword">s</span></div><div class="line">└── main</div><div class="line">    └── main.<span class="keyword">go</span></div></pre></td></tr></table></figure>

<p>package <strong>a</strong> 定义了私有的方法,并加上 <code>go:linkname</code>指令， package <strong>b</strong> 可以调用 package <strong>a</strong>的私有方法。 <strong>main.go</strong> 测试访问 <strong>b</strong>中的函数。</p>
<p>首先看看<code>a.go</code>中的实现：</p>
<figure class="highlight go"><figcaption><span>a.go</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> a</div><div class="line"></div><div class="line"><span class="keyword">import</span> (</div><div class="line">	_ <span class="string">"unsafe"</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="comment">//go:linkname say a.say</span></div><div class="line"><span class="comment">//go:nosplit</span></div><div class="line"><span class="keyword">func</span> say(name <span class="typename">string</span>) <span class="typename">string</span> {</div><div class="line">	<span class="keyword">return</span> <span class="string">"hello, "</span> + name</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//go:linkname say2 github.com/smallnest/private/b.Hi</span></div><div class="line"><span class="comment">//go:nosplit</span></div><div class="line"><span class="keyword">func</span> say2(name <span class="typename">string</span>) <span class="typename">string</span> {</div><div class="line">	<span class="keyword">return</span> <span class="string">"hi, "</span> + name</div><div class="line">}</div></pre></td></tr></table></figure>

<p>它定义了两个方法，符号名分别为<code>a.say</code>和<code>github.com/smallnest/private/b.Hi</code>。</p>
<p>这个不同的符号名的方式会影响<strong>b</strong>中的使用。</p>
<figure class="highlight go"><figcaption><span>b.go</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> b</div><div class="line"></div><div class="line"><span class="keyword">import</span> (</div><div class="line">	_ <span class="string">"unsafe"</span></div><div class="line"></div><div class="line">	_ <span class="string">"github.com/smallnest/private/a"</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="comment">//go:linkname say a.say</span></div><div class="line"><span class="keyword">func</span> say(name <span class="typename">string</span>) <span class="typename">string</span></div><div class="line"></div><div class="line"><span class="keyword">func</span> Greet(name <span class="typename">string</span>) <span class="typename">string</span> {</div><div class="line">	<span class="keyword">return</span> say(name)</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">func</span> Hi(name <span class="typename">string</span>) <span class="typename">string</span></div></pre></td></tr></table></figure>

<p>在<strong>b</strong> 中，如果想使用符号<code>a.say</code>，你还是需要<code>go:linkname</code>,告诉编译器这个函数的符号为<code>a.say</code>。对于<code>Hi</code>函数， 我们不需要<code>go:linkname</code>指令，因为在<code>a.go</code>中我们定义的符号名称<strong>恰巧</strong>就是这个<code>package.funcname</code>。</p>
<p>注意，你需要引入package <code>unsafe</code>,并且在<strong>b.go</strong>还需要import package a.</p>
<p>你可以在<code>main.go</code>中调用<strong>b</strong>:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> main</div><div class="line"></div><div class="line"><span class="keyword">import</span> (</div><div class="line">	<span class="string">"fmt"</span></div><div class="line">	<span class="string">"github.com/smallnest/private/b"</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">func</span> main() {</div><div class="line">	s := b.Greet(<span class="string">"world"</span>)</div><div class="line">	fmt.Println(s)</div><div class="line">	s = b.Hi(<span class="string">"world"</span>)</div><div class="line">	fmt.Println(s)</div><div class="line">}</div></pre></td></tr></table></figure>

<p>但是，如果你<code>go  run main.go</code>,你不会得到正确的结果，而是会出错：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">main <span class="keyword">go</span> run main.<span class="keyword">go</span></div><div class="line"># github.com/smallnest/private/b</div><div class="line">../b/b.<span class="keyword">go</span><span class="number">:10</span>: missing function body <span class="keyword">for</span> <span class="string">"say"</span></div><div class="line">../b/b.<span class="keyword">go</span><span class="number">:16</span>: missing function body <span class="keyword">for</span> <span class="string">"Hi"</span></div></pre></td></tr></table></figure>

<p>难道我们前面讲的都是错的吗？</p>
<p>这里有一个技巧，你在 package b下创建一个空的文件， w文件名随意，只要文件后缀为<code>.s</code>，再运行一下<code>go  run main.go</code>：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">main go run main.go</div><div class="line">hello, world</div><div class="line">hi, world</div></pre></td></tr></table></figure>

<p>原因在于Go在编译的时候会启用<code>-complete</code>编译器flag,它要求所有的函数必需包含函数体。创建一个空的汇编语言文件绕过这个限制。</p>
<p>当然， 一般情况下我们不会用到本文所列出的两种突破方式，只有在很稀少的情况下，为了更好地组织我们的代码，我们才会有选择的采用这两种方法。至少，作为一个Go开发者，你会记住有两种突破方法，可以打破Go语言规范中关于权限的限制。</p>
<blockquote>
<p>一个应用的例子是可以在代码中访问<code>sync.runtime_registerPoolCleanup</code>,因为它有明确的linkname</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt;   <span class="comment">//go:linkname runtime_registerPoolCleanup</span></div><div class="line">&gt;   sync.runtime_registerPoolCleanup</div><div class="line">&gt;   <span class="keyword">func</span> runtime_registerPoolCleanup(cleanup <span class="keyword">func</span>())</div><div class="line">&gt;</div></pre></td></tr></table></figure>

<p>&gt;</p>
<h3 id="访问其它package中的struct_私有字段">访问其它package中的struct 私有字段</h3>
<p>再额外附送一个技巧， 可以访问其它package struct的私有字段。</p>
<p>当然正常情况下struct的私有字段并没有export，所以在其它package是不能正常访问。通过使用<code>refect</code>,可以访问struct的私有字段:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> (</div><div class="line">	<span class="string">"fmt"</span></div><div class="line">	<span class="string">"reflect"</span></div><div class="line"></div><div class="line">	<span class="string">"github.com/smallnest/private/c"</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">func</span> ChangeFoo(f *c.Foo) {</div><div class="line">	v := reflect.ValueOf(f)</div><div class="line">	x := v.Elem().FieldByName(<span class="string">"x"</span>)</div><div class="line">	fmt.Println(x.Int())</div><div class="line">	<span class="comment">//panic: reflect: reflect.Value.SetInt using value obtained using unexported field</span></div><div class="line">	<span class="comment">//x.SetInt(100)</span></div><div class="line">	fmt.Println(x.Int())</div><div class="line"></div><div class="line">	y := v.Elem().FieldByName(<span class="string">"Y"</span>)</div><div class="line">	y.SetString(<span class="string">"world"</span>)</div><div class="line">	fmt.Println(f.Y)</div><div class="line">}</div></pre></td></tr></table></figure>

<p>但是你不能设置私有字段的值，否则会panic,这是因为<code>SetXXX</code>会首先使用<code>v.mustBeAssignable()</code>检查字段是否是exported的。</p>
<p>当然，还可以通过&quot;指针&quot;的方式获取字段的地址，通过地址获取数据或者设置数据。<br>还是用相同的例子：</p>
<figure class="highlight go"><figcaption><span>c.go</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> c</div><div class="line"></div><div class="line"><span class="keyword">type</span> Foo <span class="keyword">struct</span> {</div><div class="line">	x <span class="typename">int</span></div><div class="line">	Y <span class="typename">string</span></div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">func</span> (f Foo) X() <span class="typename">int</span> {</div><div class="line">	<span class="keyword">return</span> f.x</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">func</span> New(x <span class="typename">int</span>, y <span class="typename">string</span>) *Foo {</div><div class="line">	<span class="keyword">return</span> &Foo{x: x, Y: y}</div><div class="line">}</div></pre></td></tr></table></figure>

<p>在package d中访问：</p>
<figure class="highlight go"><figcaption><span>d.go</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> d</div><div class="line"></div><div class="line"><span class="keyword">import</span> (</div><div class="line">	<span class="string">"fmt"</span></div><div class="line">	<span class="string">"unsafe"</span></div><div class="line"></div><div class="line">	<span class="string">"github.com/smallnest/private/c"</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">func</span> ChangeFoo(f *c.Foo) {</div><div class="line">	p := unsafe.Pointer(f)</div><div class="line">	<span class="comment">// 事先获取或者通过 reflect获得</span></div><div class="line">	<span class="comment">// 本例中是第一个字段，所以offset=0</span></div><div class="line">	offset := <span class="typename">uintptr</span><span class="number">(0</span>)</div><div class="line">	ptr2x := (*<span class="typename">int</span>)(unsafe.Pointer(<span class="typename">uintptr</span>(p) + offset))</div><div class="line">	fmt.Println(*ptr2x)</div><div class="line">	*ptr2x =<span class="number"> 100</span></div><div class="line">	fmt.Println(f.X())</div><div class="line">}</div></pre></td></tr></table></figure>

<h3 id="更hack的方法">更hack的方法</h3>
<p>如果你还不满足，那么我再赠送一个更hack的方法，但是这个也有点限制，就是你腰调用的方法应该在之前的某处调用过。</p>
<p>这是 Alan Pierce 提供了一个方法。<a href="https://golang.org/src/runtime/symtab.go" target="_blank" rel="external">runtime/symtab.go</a>中保存了符号表，通过一些技巧(<code>go:linkname</code>),能访问它的私有方法，查找到想要调用的函数，然后就可以调用了，Alan将相关的代码写成了一个库，方便调用：<a href="https://github.com/alangpierce/go-forceexport" target="_blank" rel="external">go-forceexport</a>。</p>
<p>使用方法如下:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> timeNow <span class="keyword">func</span>() (<span class="typename">int64</span>, <span class="typename">int32</span>)</div><div class="line">err := forceexport.GetFunc(&timeNow, <span class="string">"time.now"</span>)</div><div class="line"><span class="keyword">if</span> err != <span class="constant">nil</span> {</div><div class="line">    <span class="comment">// Handle errors if you care about name possibly being invalid.</span></div><div class="line">}</div><div class="line"><span class="comment">// Calls the actual time.now function.</span></div><div class="line">sec, nsec := timeNow()</div></pre></td></tr></table></figure>

<p>我在使用的过程中发现只有相应的方法在某处调用过, 符号表中才有这个函数的信息， <code>forceexport.GetFunc</code>才会返回对应的函数。</p>
<p>另外，这是一个非常hack的方式，不保证Go将来的版本是否还能使用，仅供嬉戏之用，慎用在产品代码中。</p>
<h3 id="参考文档">参考文档</h3>
<ol>
<li><a href="https://golang.org/cmd/compile/" target="_blank" rel="external">https://golang.org/cmd/compile/</a></li>
<li><a href="https://github.com/golang/go/issues/15006" target="_blank" rel="external">https://github.com/golang/go/issues/15006</a></li>
<li><a href="https://siadat.github.io/post/golinkname" target="_blank" rel="external">https://siadat.github.io/post/golinkname</a></li>
<li><a href="https://sitano.github.io/2016/04/28/golang-private/" target="_blank" rel="external">https://sitano.github.io/2016/04/28/golang-private/</a></li>
<li><a href="https://golang.org/doc/go1.4#internalpackages" target="_blank" rel="external">https://golang.org/doc/go1.4#internalpackages</a></li>
<li><a href="http://www.alangpierce.com/blog/2016/03/17/adventures-in-go-accessing-unexported-functions/" target="_blank" rel="external">http://www.alangpierce.com/blog/2016/03/17/adventures-in-go-accessing-unexported-functions/</a></li>
<li><a href="https://groups.google.com/forum/#!topic/golang-nuts/ppGGazd9KXI" target="_blank" rel="external">https://groups.google.com/forum/#!topic/golang-nuts/ppGGazd9KXI</a></li>
</ol>

      
    </div>
    <footer class="article-footer">
	
<div class="bdsharebuttonbox"><a title="分享到新浪微博" class="bds_tsina" href="#" data-cmd="tsina"></a><a title="分享到微信" class="bds_weixin" href="#" data-cmd="weixin"></a><a title="分享到QQ空间" class="bds_qzone" href="#" data-cmd="qzone"></a><a title="分享到印象笔记" class="bds_evernotecn" href="#" data-cmd="evernotecn"></a><a title="分享到有道云笔记" class="bds_youdao" href="#" data-cmd="youdao"></a><a title="分享到百度云收藏" class="bds_bdysc" href="#" data-cmd="bdysc"></a><a class="bds_more" href="#" data-cmd="more"></a></div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
      

	  

      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/06/19/advanced-command-execution-in-Go-with-os-exec/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          [译]使用os/exec执行命令
        
      </div>
    </a>
  
  
    <a href="/2017/05/08/raft-and-network-partitions/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">[转]通过 raft 的 leader lease 来解决集群脑裂时的 stale read 问题</div>
    </a>
  
</nav>

  
</article>


<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<section id="comments">
  <div id="gitalk-container"></div>  
  <script type="text/javascript">
    var gitalkOpts = {
    id: '2017/05/12/call-private-functions-in-other-packa',
    owner: 'smallnest',
    repo: 'gitalk',
    title: '突破限制,访问其它Go package中的私有函数',
    body: 'http://colobu.com/2017/05/12/call-private-functions-in-other-packages/',
    clientID: 'bc02724130ed5b7ee275',
    clientSecret: '68cb0bae2f93a8b88b09e0eb9b08c844b06a9047',
    admin: ['smallnest'],
    distractionFreeMode: false
  };

  const gitalk = new Gitalk(gitalkOpts)
  gitalk.render('gitalk-container')
	</script>
  <noscript> 为正常使用评论功能请激活JavaScript</noscript>
</section>  


</section>
        
          <aside id="sidebar">
  
      <div class="widget-wrap">
    <h3 class="widget-title">原创图书</h3>
    <div class="widget">
      <a href="/ScalaCollectionsCookbook/">
        <img width="100%" src="/ScalaCollectionsCookbook/scala_collections_cookbook.jpg">
        <img width="100%" src="/ScalaCollectionsCookbook/scala_collections_cookbook_tw.png">
      </a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/DOTNET/">DOTNET</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Go/">Go</a><span class="category-list-count">98</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">62</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Scala/">Scala</a><span class="category-list-count">18</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端开发/">前端开发</a><span class="category-list-count">18</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/区块链/">区块链</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/大数据/">大数据</a><span class="category-list-count">59</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工具/">工具</a><span class="category-list-count">24</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据库/">数据库</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/架构/">架构</a><span class="category-list-count">24</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/算法/">算法</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/管理/">管理</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/网络编程/">网络编程</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/读书笔记/">读书笔记</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/运维/">运维</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/高并发编程/">高并发编程</a><span class="category-list-count">20</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Android/" style="font-size: 16.67px;">Android</a><a href="/tags/ApacheBench/" style="font-size: 11.67px;">ApacheBench</a><a href="/tags/Bower/" style="font-size: 10.00px;">Bower</a><a href="/tags/C/" style="font-size: 10.00px;">C#</a><a href="/tags/CDN/" style="font-size: 10.00px;">CDN</a><a href="/tags/CQRS/" style="font-size: 10.00px;">CQRS</a><a href="/tags/CRC/" style="font-size: 10.00px;">CRC</a><a href="/tags/CSS/" style="font-size: 11.67px;">CSS</a><a href="/tags/CompletableFuture/" style="font-size: 10.00px;">CompletableFuture</a><a href="/tags/Comsat/" style="font-size: 10.00px;">Comsat</a><a href="/tags/Curator/" style="font-size: 20.00px;">Curator</a><a href="/tags/DSL/" style="font-size: 10.00px;">DSL</a><a href="/tags/Disruptor/" style="font-size: 10.00px;">Disruptor</a><a href="/tags/Docker/" style="font-size: 11.67px;">Docker</a><a href="/tags/Ember/" style="font-size: 11.67px;">Ember</a><a href="/tags/FastJson/" style="font-size: 10.00px;">FastJson</a><a href="/tags/Fiber/" style="font-size: 10.00px;">Fiber</a><a href="/tags/GAE/" style="font-size: 10.00px;">GAE</a><a href="/tags/GC/" style="font-size: 13.33px;">GC</a><a href="/tags/Gnuplot/" style="font-size: 10.00px;">Gnuplot</a><a href="/tags/Go/" style="font-size: 13.33px;">Go</a><a href="/tags/Gradle/" style="font-size: 10.00px;">Gradle</a><a href="/tags/Grunt/" style="font-size: 10.00px;">Grunt</a><a href="/tags/Gulp/" style="font-size: 10.00px;">Gulp</a><a href="/tags/Hadoop/" style="font-size: 10.00px;">Hadoop</a><a href="/tags/Hazelcast/" style="font-size: 10.00px;">Hazelcast</a><a href="/tags/Ignite/" style="font-size: 10.00px;">Ignite</a><a href="/tags/JVM/" style="font-size: 10.00px;">JVM</a><a href="/tags/Java/" style="font-size: 18.33px;">Java</a><a href="/tags/Kafka/" style="font-size: 20.00px;">Kafka</a><a href="/tags/Lambda/" style="font-size: 15.00px;">Lambda</a><a href="/tags/Linux/" style="font-size: 13.33px;">Linux</a><a href="/tags/LongAdder/" style="font-size: 10.00px;">LongAdder</a><a href="/tags/MathJax/" style="font-size: 10.00px;">MathJax</a><a href="/tags/Maven/" style="font-size: 11.67px;">Maven</a><a href="/tags/Memcached/" style="font-size: 10.00px;">Memcached</a><a href="/tags/Metrics/" style="font-size: 10.00px;">Metrics</a><a href="/tags/Mongo/" style="font-size: 13.33px;">Mongo</a><a href="/tags/Netty/" style="font-size: 16.67px;">Netty</a><a href="/tags/Nginx/" style="font-size: 10.00px;">Nginx</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">July 2015</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">June 2015</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">May 2015</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">April 2015</a><span class="archive-list-count">15</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">March 2015</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">February 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">January 2015</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a><span class="archive-list-count">28</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">November 2014</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">October 2014</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">September 2014</a><span class="archive-list-count">28</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">August 2014</a><span class="archive-list-count">19</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/07/">July 2014</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">近期文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/03/26/channel-patterns/">Go Channel 应用模式</a>
          </li>
        
          <li>
            <a href="/2018/03/26/distributed-hash-table/">DHT 分布式哈希表</a>
          </li>
        
          <li>
            <a href="/2018/03/12/Concurrency-Utilities-Enhancements-in-Java-8-Java-9/">Java8 和 Java 9中并发工具的改变</a>
          </li>
        
          <li>
            <a href="/2018/03/12/20-Examples-of-Using-Java’s-CompletableFuture/">[译]20个使用 Java CompletableFuture的例子</a>
          </li>
        
          <li>
            <a href="/2018/03/12/Debugging-Go-Code-with-LLDB/">[译]使用 LLDB 调试 Go 程序</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">友情链接</h3>
    <div class="widget">
      <ul>
        
          <li>
			 
            <a href="http://old.colobu.com" target="_blank">以前的博客</a>
			
          </li>
        
          <li>
			 
			&nbsp;
			
          </li>
        
          <li>
			 
            <a href="http://stackshare.io" target="_blank">技术栈</a>
			
          </li>
        
          <li>
			 
			&nbsp;
			
          </li>
        
          <li>
			 
            <a href="http://weekly.manong.io/issues/" target="_blank">码农周刊</a>
			
          </li>
        
          <li>
			 
            <a href="http://www.tuicool.com/mags" target="_blank">编程狂人周刊</a>
			
          </li>
        
          <li>
			 
            <a href="http://www.importnew.com/" target="_blank">importnew</a>
			
          </li>
        
          <li>
			 
            <a href="http://ifeve.com/" target="_blank">并发编程网</a>
			
          </li>
        
          <li>
			 
			&nbsp;
			
          </li>
        
          <li>
			 
            <a href="http://github.com" target="_blank">github</a>
			
          </li>
        
          <li>
			 
            <a href="http://stackoverflow.com/" target="_blank">stackoverflow</a>
			
          </li>
        
          <li>
			 
            <a href="http://www.javacodegeeks.com/" target="_blank">javacodegeeks</a>
			
          </li>
        
          <li>
			 
            <a href="http://www.infoq.com/" target="_blank">infoq</a>
			
          </li>
        
          <li>
			 
            <a href="http://www.dzone.com/links/index.html" target="_blank">dzone</a>
			
          </li>
        
          <li>
			 
            <a href="https://oj.leetcode.com/problems/" target="_blank">leetcode</a>
			
          </li>
        
          <li>
			 
            <a href="http://tutorials.jenkov.com" target="_blank">jenkov</a>
			
          </li>
        
      </ul>
    </div>
  </div>

  
      

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 smallnest<br>
	  Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="https://github.com/smallnest" class="mobile-nav-link">github</a>
  
    <a href="/goasm" class="mobile-nav-link">Go汇编示例</a>
  
    <a href="/ScalaCollectionsCookbook" class="mobile-nav-link">Scala集合技术手册</a>
  
    <a href="/techreview" class="mobile-nav-link">技术快报</a>
  
    <a href="/about" class="mobile-nav-link">关于</a>
  
</nav>
    
<script src="//cdn.staticfile.org/jquery/1.11.1/jquery.min.js"></script>
<script src="//cdn.bootcss.com/jquery.lazyload/1.9.1/jquery.lazyload.min.js"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js"></script>


<script src="/js/script.js" type="text/javascript"></script>

<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
  });
  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>
<script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.6.0-beta.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<div id="totop" style="position:fixed;bottom:150px;right:10px;cursor: pointer;z-index: 2000;">
	<a title="返回顶部"><img src="/images/scrollup.png"/></a>
</div>
<script src="/js/totop.js" type="text/javascript"></script>



<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-142561-4']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e085d87993250aab11f3e0c15f1c2785";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


  </div>
</body>
</html>