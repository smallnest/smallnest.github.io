<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title> æ ‡å‡†åº“ä¹‹æ—… - ç®€å•è‹±è¯­å­¦Rust</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="Chapter_0.html"><strong aria-hidden="true">1.</strong>  æ›´æ–°</a></li><li class="chapter-item expanded "><a href="Chapter_1.html"><strong aria-hidden="true">2.</strong>  ä»‹ç»</a></li><li class="chapter-item expanded "><a href="Chapter_2.html"><strong aria-hidden="true">3.</strong>  æˆ‘æ˜¯è°ï¼Ÿ</a></li><li class="chapter-item expanded "><a href="Chapter_3.html"><strong aria-hidden="true">4.</strong>  ç®€å•è‹±è¯­å­¦Rust</a></li><li class="chapter-item expanded "><a href="Chapter_4.html"><strong aria-hidden="true">5.</strong>  Rust Playground</a></li><li class="chapter-item expanded "><a href="Chapter_5.html"><strong aria-hidden="true">6.</strong>  ğŸš§å’Œâš ï¸</a></li><li class="chapter-item expanded "><a href="Chapter_6.html"><strong aria-hidden="true">7.</strong>  æ³¨é‡Š</a></li><li class="chapter-item expanded "><a href="Chapter_7.html"><strong aria-hidden="true">8.</strong>  ç±»å‹</a></li><li class="chapter-item expanded "><a href="Chapter_8.html"><strong aria-hidden="true">9.</strong>  ç±»å‹æ¨å¯¼</a></li><li class="chapter-item expanded "><a href="Chapter_9.html"><strong aria-hidden="true">10.</strong>  æ‰“å°hello, world!</a></li><li class="chapter-item expanded "><a href="Chapter_10.html"><strong aria-hidden="true">11.</strong>  æ˜¾ç¤ºå’Œè°ƒè¯•</a></li><li class="chapter-item expanded "><a href="Chapter_11.html"><strong aria-hidden="true">12.</strong>  å¯å˜æ€§</a></li><li class="chapter-item expanded "><a href="Chapter_12.html"><strong aria-hidden="true">13.</strong>  æ ˆã€å †å’ŒæŒ‡é’ˆ</a></li><li class="chapter-item expanded "><a href="Chapter_13.html"><strong aria-hidden="true">14.</strong>  å…³äºæ‰“å°çš„æ›´å¤šä¿¡æ¯</a></li><li class="chapter-item expanded "><a href="Chapter_14.html"><strong aria-hidden="true">15.</strong>  å­—ç¬¦ä¸²</a></li><li class="chapter-item expanded "><a href="Chapter_15.html"><strong aria-hidden="true">16.</strong>  constå’Œstatic</a></li><li class="chapter-item expanded "><a href="Chapter_16.html"><strong aria-hidden="true">17.</strong>  å…³äºå¼•ç”¨çš„æ›´å¤šä¿¡æ¯</a></li><li class="chapter-item expanded "><a href="Chapter_17.html"><strong aria-hidden="true">18.</strong>  å¯å˜å¼•ç”¨</a></li><li class="chapter-item expanded "><a href="Chapter_18.html"><strong aria-hidden="true">19.</strong>  å‡½æ•°çš„å¼•ç”¨</a></li><li class="chapter-item expanded "><a href="Chapter_19.html"><strong aria-hidden="true">20.</strong>  æ‹·è´ç±»å‹</a></li><li class="chapter-item expanded "><a href="Chapter_20.html"><strong aria-hidden="true">21.</strong>  é›†åˆç±»å‹</a></li><li class="chapter-item expanded "><a href="Chapter_21.html"><strong aria-hidden="true">22.</strong>  å‘é‡</a></li><li class="chapter-item expanded "><a href="Chapter_22.html"><strong aria-hidden="true">23.</strong>  å…ƒç»„</a></li><li class="chapter-item expanded "><a href="Chapter_23.html"><strong aria-hidden="true">24.</strong>  æ§åˆ¶æµ</a></li><li class="chapter-item expanded "><a href="Chapter_24.html"><strong aria-hidden="true">25.</strong>  ç»“æ„ä½“</a></li><li class="chapter-item expanded "><a href="Chapter_25.html"><strong aria-hidden="true">26.</strong>  æšä¸¾</a></li><li class="chapter-item expanded "><a href="Chapter_26.html"><strong aria-hidden="true">27.</strong>  å¾ªç¯</a></li><li class="chapter-item expanded "><a href="Chapter_27.html"><strong aria-hidden="true">28.</strong>  å®ç°ç»“æ„ä½“å’Œæšä¸¾</a></li><li class="chapter-item expanded "><a href="Chapter_28.html"><strong aria-hidden="true">29.</strong>  è§£æ„</a></li><li class="chapter-item expanded "><a href="Chapter_29.html"><strong aria-hidden="true">30.</strong>  å¼•ç”¨å’Œç‚¹è¿ç®—ç¬¦</a></li><li class="chapter-item expanded "><a href="Chapter_30.html"><strong aria-hidden="true">31.</strong>  æ³›å‹</a></li><li class="chapter-item expanded "><a href="Chapter_31.html"><strong aria-hidden="true">32.</strong>  Optionå’ŒResult</a></li><li class="chapter-item expanded "><a href="Chapter_32.html"><strong aria-hidden="true">33.</strong>  å…¶ä»–é›†åˆç±»å‹</a></li><li class="chapter-item expanded "><a href="Chapter_33.html"><strong aria-hidden="true">34.</strong>  ?æ“ä½œç¬¦</a></li><li class="chapter-item expanded "><a href="Chapter_34.html"><strong aria-hidden="true">35.</strong>  ç‰¹æ€§</a></li><li class="chapter-item expanded "><a href="Chapter_35.html"><strong aria-hidden="true">36.</strong>  é“¾å¼æ–¹æ³•</a></li><li class="chapter-item expanded "><a href="Chapter_36.html"><strong aria-hidden="true">37.</strong>  è¿­ä»£å™¨</a></li><li class="chapter-item expanded "><a href="Chapter_37.html"><strong aria-hidden="true">38.</strong>  é—­åŒ…</a></li><li class="chapter-item expanded "><a href="Chapter_38.html"><strong aria-hidden="true">39.</strong>  dbg! å®å’Œ.inspect</a></li><li class="chapter-item expanded "><a href="Chapter_39.html"><strong aria-hidden="true">40.</strong>  &strçš„ç±»å‹</a></li><li class="chapter-item expanded "><a href="Chapter_40.html"><strong aria-hidden="true">41.</strong>  ç”Ÿå‘½æœŸ</a></li><li class="chapter-item expanded "><a href="Chapter_41.html"><strong aria-hidden="true">42.</strong>  å†…éƒ¨å¯å˜æ€§</a></li><li class="chapter-item expanded "><a href="Chapter_42.html"><strong aria-hidden="true">43.</strong>  Cow</a></li><li class="chapter-item expanded "><a href="Chapter_43.html"><strong aria-hidden="true">44.</strong>  ç±»å‹åˆ«å</a></li><li class="chapter-item expanded "><a href="Chapter_44.html"><strong aria-hidden="true">45.</strong>  todo!å®</a></li><li class="chapter-item expanded "><a href="Chapter_45.html"><strong aria-hidden="true">46.</strong>  Rc</a></li><li class="chapter-item expanded "><a href="Chapter_46.html"><strong aria-hidden="true">47.</strong>  å¤šçº¿ç¨‹</a></li><li class="chapter-item expanded "><a href="Chapter_47.html"><strong aria-hidden="true">48.</strong>  å‡½æ•°ä¸­çš„é—­åŒ…</a></li><li class="chapter-item expanded "><a href="Chapter_48.html"><strong aria-hidden="true">49.</strong>  impl Trait</a></li><li class="chapter-item expanded "><a href="Chapter_49.html"><strong aria-hidden="true">50.</strong>  Arc</a></li><li class="chapter-item expanded "><a href="Chapter_50.html"><strong aria-hidden="true">51.</strong>  Channels</a></li><li class="chapter-item expanded "><a href="Chapter_51.html"><strong aria-hidden="true">52.</strong>  é˜…è¯»Rustæ–‡æ¡£</a></li><li class="chapter-item expanded "><a href="Chapter_52.html"><strong aria-hidden="true">53.</strong>  å±æ€§</a></li><li class="chapter-item expanded "><a href="Chapter_53.html"><strong aria-hidden="true">54.</strong>  Box</a></li><li class="chapter-item expanded "><a href="Chapter_54.html"><strong aria-hidden="true">55.</strong>  ç”¨BoxåŒ…è£¹trait</a></li><li class="chapter-item expanded "><a href="Chapter_55.html"><strong aria-hidden="true">56.</strong>  é»˜è®¤å€¼å’Œå»ºé€ è€…æ¨¡å¼</a></li><li class="chapter-item expanded "><a href="Chapter_56.html"><strong aria-hidden="true">57.</strong>  Derefå’ŒDerefMut</a></li><li class="chapter-item expanded "><a href="Chapter_57.html"><strong aria-hidden="true">58.</strong>  Crateå’Œæ¨¡å—</a></li><li class="chapter-item expanded "><a href="Chapter_58.html"><strong aria-hidden="true">59.</strong>  æµ‹è¯•</a></li><li class="chapter-item expanded "><a href="Chapter_59.html"><strong aria-hidden="true">60.</strong>  å¤–éƒ¨crate</a></li><li class="chapter-item expanded "><a href="Chapter_60.html" class="active"><strong aria-hidden="true">61.</strong>  æ ‡å‡†åº“ä¹‹æ—…</a></li><li class="chapter-item expanded "><a href="Chapter_61.html"><strong aria-hidden="true">62.</strong>  ç¼–å†™å®</a></li><li class="chapter-item expanded "><a href="Chapter_62.html"><strong aria-hidden="true">63.</strong>  cargo</a></li><li class="chapter-item expanded "><a href="Chapter_63.html"><strong aria-hidden="true">64.</strong>  æ¥å—ç”¨æˆ·è¾“å…¥</a></li><li class="chapter-item expanded "><a href="Chapter_64.html"><strong aria-hidden="true">65.</strong>  ä½¿ç”¨æ–‡ä»¶</a></li><li class="chapter-item expanded "><a href="Chapter_65.html"><strong aria-hidden="true">66.</strong>  cargoæ–‡æ¡£</a></li><li class="chapter-item expanded "><a href="Chapter_66.html"><strong aria-hidden="true">67.</strong>  ç»“æŸäº†å—ï¼Ÿ</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">ç®€å•è‹±è¯­å­¦Rust</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2 id="æ ‡å‡†åº“ä¹‹æ—…"><a class="header" href="#æ ‡å‡†åº“ä¹‹æ—…">æ ‡å‡†åº“ä¹‹æ—…</a></h2>
<p>ç°åœ¨ä½ å·²ç»çŸ¥é“äº†å¾ˆå¤šRustçš„çŸ¥è¯†ï¼Œä½ å°†èƒ½å¤Ÿç†è§£æ ‡å‡†åº“é‡Œé¢çš„å¤§éƒ¨åˆ†ä¸œè¥¿ã€‚å®ƒé‡Œé¢çš„ä»£ç å·²ç»ä¸æ˜¯é‚£ä¹ˆå¯æ€•äº†ã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒé‡Œé¢ä¸€äº›æˆ‘ä»¬è¿˜æ²¡æœ‰å­¦è¿‡çš„éƒ¨åˆ†ã€‚æœ¬ç¯‡æ¸¸è®°å°†ä»‹ç»æ ‡å‡†åº“çš„å¤§éƒ¨åˆ†éƒ¨åˆ†ï¼Œä½ ä¸éœ€è¦å®‰è£…Rustã€‚æˆ‘ä»¬å°†é‡æ¸©å¾ˆå¤šæˆ‘ä»¬å·²ç»çŸ¥é“çš„å†…å®¹ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ›´æ·±å…¥åœ°å­¦ä¹ å®ƒä»¬ã€‚</p>
<h3 id="æ•°ç»„"><a class="header" href="#æ•°ç»„">æ•°ç»„</a></h3>
<p>å…³äºæ•°ç»„éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œå®ƒä»¬æ²¡æœ‰å®ç°<code>Iterator.</code>ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªæ•°ç»„ï¼Œä½ ä¸èƒ½ä½¿ç”¨<code>for</code>ã€‚ä½†æ˜¯ä½ å¯ä»¥å¯¹å®ƒä»¬ä½¿ç”¨ <code>.iter()</code> è¿™æ ·çš„æ–¹æ³•ã€‚æˆ–è€…ä½ å¯ä»¥ä½¿ç”¨<code>&amp;</code>æ¥å¾—åˆ°ä¸€ä¸ªåˆ‡ç‰‡ã€‚å®é™…ä¸Šï¼Œå¦‚æœä½ å°è¯•ä½¿ç”¨<code>for</code>ï¼Œç¼–è¯‘å™¨ä¼šå‡†ç¡®åœ°å‘Šè¯‰ä½ ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    // âš ï¸
    let my_cities = ["Beirut", "Tel Aviv", "Nicosia"];

    for city in my_cities {
        println!("{}", city);
    }
}</code></pre></pre>
<p>æ¶ˆæ¯æ˜¯:</p>
<pre><code class="language-text">error[E0277]: `[&amp;str; 3]` is not an iterator
 --&gt; src\main.rs:5:17
  |
  |                 ^^^^^^^^^ borrow the array with `&amp;` or call `.iter()` on it to iterate over it
</code></pre>
<p>æ‰€ä»¥è®©æˆ‘ä»¬è¯•è¯•è¿™ä¸¤ç§æ–¹æ³•ã€‚å®ƒä»¬çš„ç»“æœæ˜¯ä¸€æ ·çš„ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let my_cities = ["Beirut", "Tel Aviv", "Nicosia"];

    for city in &amp;my_cities {
        println!("{}", city);
    }
    for city in my_cities.iter() {
        println!("{}", city);
    }
}</code></pre></pre>
<p>è¿™ä¸ªæ‰“å°:</p>
<pre><code class="language-text">Beirut
Tel Aviv
Nicosia
Beirut
Tel Aviv
Nicosia
</code></pre>
<p>å¦‚æœä½ æƒ³ä»ä¸€ä¸ªæ•°ç»„ä¸­è·å–å˜é‡ï¼Œä½ å¯ä»¥æŠŠå®ƒä»¬çš„åå­—æ”¾åœ¨ <code>[]</code> ä¸­æ¥è§£æ„å®ƒã€‚è¿™ä¸åœ¨ <code>match</code> è¯­å¥ä¸­ä½¿ç”¨å…ƒç»„æˆ–ä»ç»“æ„ä½“ä¸­è·å–å˜é‡æ˜¯ä¸€æ ·çš„ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let my_cities = ["Beirut", "Tel Aviv", "Nicosia"];
    let [city1, city2, city3] = my_cities;
    println!("{}", city1);
}</code></pre></pre>
<p>æ‰“å°å‡º<code>Beirut</code>.</p>
<h3 id="char"><a class="header" href="#char">char</a></h3>
<p>æ‚¨å¯ä»¥ä½¿ç”¨<code>.escape_unicode()</code>çš„æ–¹æ³•æ¥è·å–<code>char</code>çš„Unicodeå·ç ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let korean_word = "ì²­ì¶˜ì˜ˆì°¬";
    for character in korean_word.chars() {
        print!("{} ", character.escape_unicode());
    }
}</code></pre></pre>
<p>è¿™å°†æ‰“å°å‡º <code>u{ccad} u{cd98} u{c608} u{cc2c}</code>ã€‚</p>
<p>ä½ å¯ä»¥ä½¿ç”¨ <code>From</code> traitä» <code>u8</code> ä¸­å¾—åˆ°ä¸€ä¸ªå­—ç¬¦ï¼Œä½†å¯¹äº <code>u32</code>ï¼Œä½ ä½¿ç”¨ <code>TryFrom</code>ï¼Œå› ä¸ºå®ƒå¯èƒ½æ— æ³•å·¥ä½œã€‚<code>u32</code>ä¸­çš„æ•°å­—æ¯”Unicodeä¸­çš„å­—ç¬¦å¤šå¾ˆå¤šã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªç®€å•çš„æ¼”ç¤ºæ¥äº†è§£ã€‚</p>
<pre><pre class="playground"><code class="language-rust">use std::convert::TryFrom; // You need to bring TryFrom in to use it
use rand::prelude::*;      // We will use random numbers too

fn main() {
    let some_character = char::from(99); // This one is easy - no need for TryFrom
    println!("{}", some_character);

    let mut random_generator = rand::thread_rng();
    // This will try 40,000 times to make a char from a u32.
    // The range is 0 (std::u32::MIN) to u32's highest number (std::u32::MAX). If it doesn't work, we will give it '-'.
    for _ in 0..40_000 {
        let bigger_character = char::try_from(random_generator.gen_range(std::u32::MIN..std::u32::MAX)).unwrap_or('-');
        print!("{}", bigger_character)
    }
}</code></pre></pre>
<p>å‡ ä¹æ¯æ¬¡éƒ½ä¼šç”Ÿæˆä¸€ä¸ª<code>-</code>ã€‚è¿™æ˜¯ä½ ä¼šçœ‹åˆ°çš„é‚£ç§è¾“å‡ºçš„ä¸€éƒ¨åˆ†ã€‚</p>
<pre><code class="language-text">------------------------------------------------------------------------ğ¤’°---------------------
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
-------------------------------------------------------------ì¶—--------------------------------
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
------------ò‡œ----------------------------------------------------
</code></pre>
<p>æ‰€ä»¥ï¼Œä½ è¦ç”¨<code>TryFrom</code>æ˜¯ä»¶å¥½äº‹ã€‚</p>
<p>å¦å¤–ï¼Œä»2020å¹´8æœˆåº•å¼€å§‹ï¼Œä½ ç°åœ¨å¯ä»¥ä»<code>char</code>ä¸­å¾—åˆ°ä¸€ä¸ª<code>String</code>ã€‚(<code>String</code>å®ç°äº†<code>From&lt;char&gt;</code>)åªè¦å†™<code>String::from()</code>ï¼Œç„¶ååœ¨é‡Œé¢æ”¾ä¸€ä¸ª<code>char</code>ã€‚</p>
<h3 id="æ•´æ•°"><a class="header" href="#æ•´æ•°">æ•´æ•°</a></h3>
<p>è¿™äº›ç±»å‹çš„æ•°å­¦æ–¹æ³•æœ‰å¾ˆå¤šï¼Œå¦å¤–è¿˜æœ‰ä¸€äº›å…¶ä»–çš„æ–¹æ³•ã€‚ä¸‹é¢æ˜¯ä¸€äº›æœ€æœ‰ç”¨çš„ã€‚</p>
<p><code>.checked_add()</code>, <code>.checked_sub()</code>, <code>.checked_mul()</code>, <code>.checked_div()</code>. å¦‚æœä½ è®¤ä¸ºä½ å¯èƒ½ä¼šå¾—åˆ°ä¸€ä¸ªä¸é€‚åˆç±»å‹çš„æ•°å­—ï¼Œè¿™äº›éƒ½æ˜¯ä¸é”™çš„æ–¹æ³•ã€‚å®ƒä»¬ä¼šè¿”å›ä¸€ä¸ª <code>Option</code>ï¼Œè¿™æ ·ä½ å°±å¯ä»¥å®‰å…¨åœ°æ£€æŸ¥ä½ çš„æ•°å­¦è®¡ç®—æ˜¯å¦æ­£å¸¸ï¼Œè€Œä¸ä¼šè®©ç¨‹åºå´©æºƒã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let some_number = 200_u8;
    let other_number = 200_u8;

    println!("{:?}", some_number.checked_add(other_number));
    println!("{:?}", some_number.checked_add(1));
}</code></pre></pre>
<p>è¿™ä¸ªæ‰“å°:</p>
<pre><code class="language-text">None
Some(201)
</code></pre>
<p>ä½ ä¼šæ³¨æ„åˆ°ï¼Œåœ¨æ•´æ•°çš„é¡µé¢ä¸Šï¼Œç»å¸¸è¯´<code>rhs</code>ã€‚è¿™æ„å‘³ç€ "å³è¾¹"ï¼Œä¹Ÿå°±æ˜¯ä½ åšä¸€äº›æ•°å­¦è¿ç®—æ—¶çš„å³æ“ä½œæ•°ã€‚æ¯”å¦‚åœ¨<code>5 + 6</code>ä¸­ï¼Œ<code>5</code>åœ¨å·¦è¾¹ï¼Œ<code>6</code>åœ¨å³è¾¹ï¼Œæ‰€ä»¥<code>6</code>å°±æ˜¯<code>rhs</code>ã€‚è¿™ä¸ªä¸æ˜¯å…³é”®è¯ï¼Œä½†æ˜¯ä½ ä¼šç»å¸¸çœ‹åˆ°ï¼Œæ‰€ä»¥çŸ¥é“å°±å¥½ã€‚</p>
<p>è¯´åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬æ¥å­¦ä¹ ä¸€ä¸‹å¦‚ä½•å®ç°<code>Add</code>ã€‚åœ¨ä½ å®ç°äº†<code>Add</code>ä¹‹åï¼Œä½ å¯ä»¥åœ¨ä½ åˆ›å»ºçš„ç±»å‹ä¸Šä½¿ç”¨<code>+</code>ã€‚ä½ éœ€è¦è‡ªå·±å®ç°<code>Add</code>ï¼Œå› ä¸ºaddå¯ä»¥è¡¨è¾¾å¾ˆå¤šæ„æ€ã€‚è¿™æ˜¯æ ‡å‡†åº“é¡µé¢ä¸­çš„ä¾‹å­ã€‚</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use std::ops::Add; // first bring in Add

#[derive(Debug, Copy, Clone, PartialEq)] // PartialEq is probably the most important part here. You want to be able to compare numbers
struct Point {
    x: i32,
    y: i32,
}

impl Add for Point {
    type Output = Self; // Remember, this is called an "associated type": a "type that goes together".
                        // In this case it's just another Point

    fn add(self, other: Self) -&gt; Self {
        Self {
            x: self.x + other.x,
            y: self.y + other.y,
        }
    }
}
<span class="boring">}</span></code></pre></pre>
<p>ç°åœ¨è®©æˆ‘ä»¬ä¸ºè‡ªå·±çš„ç±»å‹å®ç°<code>Add</code>ã€‚è®©æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬æƒ³æŠŠä¸¤ä¸ªå›½å®¶åŠ åœ¨ä¸€èµ·ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ¯”è¾ƒå®ƒä»¬çš„ç»æµã€‚å®ƒçœ‹èµ·æ¥åƒè¿™æ ·:</p>
<pre><pre class="playground"><code class="language-rust">use std::fmt;
use std::ops::Add;

#[derive(Clone)]
struct Country {
    name: String,
    population: u32,
    gdp: u32, // This is the size of the economy
}

impl Country {
    fn new(name: &amp;str, population: u32, gdp: u32) -&gt; Self {
        Self {
            name: name.to_string(),
            population,
            gdp,
        }
    }
}

impl Add for Country {
    type Output = Self;

    fn add(self, other: Self) -&gt; Self {
        Self {
            name: format!("{} and {}", self.name, other.name), // We will add the names together,
            population: self.population + other.population, // and the population,
            gdp: self.gdp + other.gdp,   // and the GDP
        }
    }
}

impl fmt::Display for Country {
    fn fmt(&amp;self, f: &amp;mut fmt::Formatter&lt;'_&gt;) -&gt; fmt::Result {
        write!(
            f,
            "In {} are {} people and a GDP of ${}", // Then we can print them all with just {}
            self.name, self.population, self.gdp
        )
    }
}

fn main() {
    let nauru = Country::new("Nauru", 10_670, 160_000_000);
    let vanuatu = Country::new("Vanuatu", 307_815, 820_000_000);
    let micronesia = Country::new("Micronesia", 104_468, 367_000_000);

    // We could have given Country a &amp;str instead of a String for the name. But we would have to write lifetimes everywhere
    // and that would be too much for a small example. Better to just clone them when we call println!.
    println!("{}", nauru.clone());
    println!("{}", nauru.clone() + vanuatu.clone());
    println!("{}", nauru + vanuatu + micronesia);
}</code></pre></pre>
<p>è¿™ä¸ªæ‰“å°:</p>
<pre><code class="language-text">In Nauru are 10670 people and a GDP of $160000000
In Nauru and Vanuatu are 318485 people and a GDP of $980000000
In Nauru and Vanuatu and Micronesia are 422953 people and a GDP of $1347000000
</code></pre>
<p>ä»¥ååœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ<code>.fmt()</code>æ”¹æˆæ›´å®¹æ˜“é˜…è¯»çš„æ•°å­—æ˜¾ç¤ºã€‚</p>
<p>å¦å¤–ä¸‰ä¸ªå«<code>Sub</code>ã€<code>Mul</code>å’Œ<code>Div</code>ï¼Œå®ç°èµ·æ¥åŸºæœ¬ä¸€æ ·ã€‚<code>+=</code>ã€<code>-=</code>ã€<code>*=</code>å’Œ<code>/=</code>ï¼Œåªè¦åŠ ä¸Š<code>Assign</code>:<code>AddAssign</code>ã€<code>SubAssign</code>ã€<code>MulAssign</code>å’Œ<code>DivAssign</code>å³å¯ã€‚ä½ å¯ä»¥çœ‹åˆ°å®Œæ•´çš„åˆ—è¡¨<a href="https://doc.rust-lang.org/std/ops/index.html#structs">è¿™é‡Œ</a>ï¼Œå› ä¸ºè¿˜æœ‰å¾ˆå¤šã€‚ä¾‹å¦‚ <code>%</code> è¢«ç§°ä¸º <code>Rem</code>, <code>-</code> è¢«ç§°ä¸º <code>Neg</code>, ç­‰ç­‰ã€‚</p>
<h3 id="æµ®ç‚¹æ•°"><a class="header" href="#æµ®ç‚¹æ•°">æµ®ç‚¹æ•°</a></h3>
<p><code>f32</code>å’Œ<code>f64</code>æœ‰éå¸¸å¤šçš„æ–¹æ³•ï¼Œä½ åœ¨åšæ•°å­¦è®¡ç®—çš„æ—¶å€™ä¼šç”¨åˆ°ã€‚æˆ‘ä»¬ä¸çœ‹è¿™äº›ï¼Œä½†è¿™é‡Œæœ‰ä¸€äº›ä½ å¯èƒ½ä¼šç”¨åˆ°çš„æ–¹æ³•ã€‚å®ƒä»¬åˆ†åˆ«æ˜¯ <code>.floor()</code>, <code>.ceil()</code>, <code>.round()</code>, å’Œ <code>.trunc()</code>. æ‰€æœ‰è¿™äº›æ–¹æ³•éƒ½è¿”å›ä¸€ä¸ª <code>f32</code> æˆ– <code>f64</code>ï¼Œå®ƒåƒä¸€ä¸ªæ•´æ•°ï¼Œå°æ•°ç‚¹åé¢æ˜¯ <code>0</code>ã€‚å®ƒä»¬æ˜¯è¿™æ ·åšçš„ã€‚</p>
<ul>
<li><code>.floor()</code>: ç»™ä½ ä¸‹ä¸€ä¸ªæœ€ä½çš„æ•´æ•°.</li>
<li><code>.ceil()</code>: ç»™ä½ ä¸‹ä¸€ä¸ªæœ€é«˜çš„æ•´æ•°ã€‚</li>
<li><code>.round()</code>: å¦‚æœå°æ•°éƒ¨åˆ†å¤§äºç­‰äº0.5ï¼Œè¿”å›æ•°å€¼åŠ 1;å¦‚æœå°æ•°éƒ¨åˆ†å°äº0.5ï¼Œè¿”å›ç›¸åŒæ•°å€¼ã€‚è¿™å°±æ˜¯æ‰€è°“çš„å››èˆäº”å…¥ï¼Œå› ä¸ºå®ƒç»™ä½ ä¸€ä¸ª "èˆå…¥"çš„æ•°å­—(ä¸€ä¸ªæ•°å­—çš„ç®€çŸ­å½¢å¼)ã€‚</li>
<li><code>.trunc()</code>:åªæ˜¯æŠŠå°æ•°ç‚¹å·åçš„éƒ¨åˆ†æˆªæ‰ã€‚Truncateæ˜¯ "æˆªæ–­"çš„æ„æ€ã€‚</li>
</ul>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªç®€å•çš„å‡½æ•°æ¥æ‰“å°å®ƒä»¬ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn four_operations(input: f64) {
    println!(
"For the number {}:
floor: {}
ceiling: {}
rounded: {}
truncated: {}\n",
        input,
        input.floor(),
        input.ceil(),
        input.round(),
        input.trunc()
    );
}

fn main() {
    four_operations(9.1);
    four_operations(100.7);
    four_operations(-1.1);
    four_operations(-19.9);
}</code></pre></pre>
<p>è¿™ä¸ªæ‰“å°:</p>
<pre><code class="language-text">For the number 9.1:
floor: 9
ceiling: 10
rounded: 9 // because less than 9.5
truncated: 9

For the number 100.7:
floor: 100
ceiling: 101
rounded: 101 // because more than 100.5
truncated: 100

For the number -1.1:
floor: -2
ceiling: -1
rounded: -1
truncated: -1

For the number -19.9:
floor: -20
ceiling: -19
rounded: -20
truncated: -19
</code></pre>
<p><code>f32</code> å’Œ <code>f64</code> æœ‰ä¸€ä¸ªå«åš <code>.max()</code> å’Œ <code>.min()</code> çš„æ–¹æ³•ï¼Œå¯ä»¥å¾—åˆ°ä¸¤ä¸ªæ•°å­—ä¸­è¾ƒå¤§æˆ–è¾ƒå°çš„æ•°å­—ã€‚(å¯¹äºå…¶ä»–ç±»å‹ï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨<code>std::cmp::max</code>å’Œ<code>std::cmp::min</code>ã€‚)ä¸‹é¢æ˜¯ç”¨<code>.fold()</code>æ¥å¾—åˆ°æœ€é«˜æˆ–æœ€ä½æ•°çš„æ–¹æ³•ã€‚ä½ åˆå¯ä»¥çœ‹åˆ°ï¼Œ<code>.fold()</code>ä¸ä»…ä»…æ˜¯ç”¨æ¥åŠ æ•°å­—çš„ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let my_vec = vec![8.0_f64, 7.6, 9.4, 10.0, 22.0, 77.345, 10.22, 3.2, -7.77, -10.0];
    let maximum = my_vec.iter().fold(f64::MIN, |current_number, next_number| current_number.max(*next_number)); // Note: start with the lowest possible number for an f64.
    let minimum = my_vec.iter().fold(f64::MAX, |current_number, next_number| current_number.min(*next_number)); // And here start with the highest possible number
    println!("{}, {}", maximum, minimum);
}</code></pre></pre>
<h3 id="bool"><a class="header" href="#bool">bool</a></h3>
<p>åœ¨ Rust ä¸­ï¼Œå¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥æŠŠ <code>bool</code> å˜æˆä¸€ä¸ªæ•´æ•°ï¼Œå› ä¸ºè¿™æ ·åšæ˜¯å®‰å…¨çš„ã€‚ä½†ä½ ä¸èƒ½åè¿‡æ¥åšã€‚å¦‚ä½ æ‰€è§ï¼Œ<code>true</code>å˜æˆäº†1ï¼Œ<code>false</code>å˜æˆäº†0ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let true_false = (true, false);
    println!("{} {}", true_false.0 as u8, true_false.1 as i32);
}</code></pre></pre>
<p>è¿™å°†æ‰“å°å‡º<code>1 0</code>ã€‚å¦‚æœä½ å‘Šè¯‰ç¼–è¯‘å™¨ç±»å‹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>.into()</code>ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let true_false: (i128, u16) = (true.into(), false.into());
    println!("{} {}", true_false.0, true_false.1);
}</code></pre></pre>
<p>è¿™æ‰“å°çš„æ˜¯ä¸€æ ·çš„ä¸œè¥¿ã€‚</p>
<p>ä»Rust 1.50(2021å¹´2æœˆå‘å¸ƒ)å¼€å§‹ï¼Œæœ‰ä¸€ä¸ªå«åš <code>then()</code>çš„æ–¹æ³•ï¼Œå®ƒå°†ä¸€ä¸ª <code>bool</code>å˜æˆä¸€ä¸ª <code>Option</code>ã€‚ä½¿ç”¨<code>then()</code>æ—¶éœ€è¦ä¸€ä¸ªé—­åŒ…ï¼Œå¦‚æœitemæ˜¯<code>true</code>ï¼Œé—­åŒ…å°±ä¼šè¢«è°ƒç”¨ã€‚åŒæ—¶ï¼Œæ— è®ºä»é—­åŒ…ä¸­è¿”å›ä»€ä¹ˆï¼Œéƒ½ä¼šè¿›å…¥<code>Option</code>ä¸­ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå°ä¾‹å­:</p>
<pre><pre class="playground"><code class="language-rust">fn main() {

    let (tru, fals) = (true.then(|| 8), false.then(|| 8));
    println!("{:?}, {:?}", tru, fals);
}</code></pre></pre>
<p>è¿™ä¸ªæ‰“å° <code>Some(8), None</code>ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªè¾ƒé•¿çš„ä¾‹å­:</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let bool_vec = vec![true, false, true, false, false];

    let option_vec = bool_vec
        .iter()
        .map(|item| {
            item.then(|| { // Put this inside of map so we can pass it on
                println!("Got a {}!", item);
                "It's true, you know" // This goes inside Some if it's true
                                      // Otherwise it just passes on None
            })
        })
        .collect::&lt;Vec&lt;_&gt;&gt;();

    println!("Now we have: {:?}", option_vec);

    // That printed out the Nones too. Let's filter map them out in a new Vec.
    let filtered_vec = option_vec.into_iter().filter_map(|c| c).collect::&lt;Vec&lt;_&gt;&gt;();

    println!("And without the Nones: {:?}", filtered_vec);
}</code></pre></pre>
<p>å°†æ‰“å°:</p>
<pre><code class="language-text">Got a true!
Got a true!
Now we have: [Some("It\'s true, you know"), None, Some("It\'s true, you know"), None, None]
And without the Nones: ["It\'s true, you know", "It\'s true, you know"]
</code></pre>
<h3 id="vec"><a class="header" href="#vec">Vec</a></h3>
<p>Vecæœ‰å¾ˆå¤šæ–¹æ³•æˆ‘ä»¬è¿˜æ²¡æœ‰çœ‹ã€‚å…ˆè¯´è¯´<code>.sort()</code>ã€‚<code>.sort()</code>ä¸€ç‚¹éƒ½ä¸å¥‡æ€ªã€‚å®ƒä½¿ç”¨<code>&amp;mut self</code>æ¥å¯¹ä¸€ä¸ªå‘é‡è¿›è¡Œæ’åºã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let mut my_vec = vec![100, 90, 80, 0, 0, 0, 0, 0];
    my_vec.sort();
    println!("{:?}", my_vec);
}</code></pre></pre>
<p>è¿™æ ·æ‰“å°å‡ºæ¥çš„æ˜¯<code>[0, 0, 0, 0, 0, 80, 90, 100]</code>ã€‚ä½†è¿˜æœ‰ä¸€ç§æ›´æœ‰è¶£çš„æ’åºæ–¹å¼å«<code>.sort_unstable()</code>ï¼Œå®ƒé€šå¸¸æ›´å¿«ã€‚å®ƒä¹‹æ‰€ä»¥æ›´å¿«ï¼Œæ˜¯å› ä¸ºå®ƒä¸åœ¨ä¹æ’åºå‰åç›¸åŒæ•°å­—çš„å…ˆåé¡ºåºã€‚åœ¨å¸¸è§„çš„<code>.sort()</code>ä¸­ï¼Œä½ çŸ¥é“æœ€åçš„<code>0, 0, 0, 0, 0</code>ä¼šåœ¨<code>.sort()</code>ä¹‹åçš„é¡ºåºç›¸åŒã€‚ä½†æ˜¯<code>.sort_unstable()</code>å¯èƒ½ä¼šæŠŠæœ€åä¸€ä¸ª0ç§»åˆ°ç´¢å¼•0ï¼Œç„¶åæŠŠç¬¬ä¸‰ä¸ªæœ€åçš„0ç§»åˆ°ç´¢å¼•2ï¼Œç­‰ç­‰ã€‚</p>
<p><code>.dedup()</code>çš„æ„æ€æ˜¯ "å»é‡å¤"ã€‚å®ƒå°†åˆ é™¤ä¸€ä¸ªå‘é‡ä¸­ç›¸åŒçš„å…ƒç´ ï¼Œä½†åªæœ‰å½“å®ƒä»¬å½¼æ­¤ç›¸é‚»æ—¶æ‰ä¼šåˆ é™¤ã€‚æ¥ä¸‹æ¥è¿™æ®µä»£ç ä¸ä¼šåªæ‰“å°<code>"sun", "moon"</code>ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let mut my_vec = vec!["sun", "sun", "moon", "moon", "sun", "moon", "moon"];
    my_vec.dedup();
    println!("{:?}", my_vec);
}</code></pre></pre>
<p>å®ƒåªæ˜¯æŠŠå¦ä¸€ä¸ª "sun"æ—è¾¹çš„ "sun"å»æ‰ï¼Œç„¶åæŠŠä¸€ä¸ª "moon"æ—è¾¹çš„ "moon"å»æ‰ï¼Œå†æŠŠå¦ä¸€ä¸ª "moon"æ—è¾¹çš„ "moon"å»æ‰ã€‚ç»“æœæ˜¯ <code>["sun", "moon", "sun", "moon"]</code>.</p>
<p>å¦‚æœä½ æƒ³æŠŠæ¯ä¸ªé‡å¤çš„ä¸œè¥¿éƒ½å»æ‰ï¼Œå°±å…ˆ<code>.sort()</code>:</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let mut my_vec = vec!["sun", "sun", "moon", "moon", "sun", "moon", "moon"];
    my_vec.sort();
    my_vec.dedup();
    println!("{:?}", my_vec);
}</code></pre></pre>
<p>ç»“æœ:<code>["moon", "sun"]</code>.</p>
<h3 id="string"><a class="header" href="#string">String</a></h3>
<p>ä½ ä¼šè®°å¾—ï¼Œ<code>String</code>æœ‰ç‚¹åƒ<code>Vec</code>ã€‚å®ƒå¾ˆåƒ<code>Vec</code>ï¼Œä½ å¯ä»¥è°ƒç”¨å¾ˆå¤šç›¸åŒçš„æ–¹æ³•ã€‚æ¯”å¦‚è¯´ï¼Œä½ å¯ä»¥ç”¨<code>String::with_capacity()</code>åˆ›å»ºä¸€ä¸ªï¼Œå¦‚æœä½ éœ€è¦å¤šæ¬¡ç”¨<code>.push()</code>æ¨ä¸€ä¸ª<code>char</code>ï¼Œæˆ–è€…ç”¨<code>.push_str()</code>æ¨ä¸€ä¸ª<code>&amp;str</code>ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªæœ‰å¤šæ¬¡å†…å­˜åˆ†é…çš„<code>String</code>çš„ä¾‹å­ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let mut push_string = String::new();
    let mut capacity_counter = 0; // capacity starts at 0
    for _ in 0..100_000 { // Do this 100,000 times
        if push_string.capacity() != capacity_counter { // First check if capacity is different now
            println!("{}", push_string.capacity()); // If it is, print it
            capacity_counter = push_string.capacity(); // then update the counter
        }
        push_string.push_str("I'm getting pushed into the string!"); // and push this in every time
    }
}</code></pre></pre>
<p>è¿™ä¸ªæ‰“å°:</p>
<pre><code class="language-text">35
70
140
280
560
1120
2240
4480
8960
17920
35840
71680
143360
286720
573440
1146880
2293760
4587520
</code></pre>
<p>æˆ‘ä»¬ä¸å¾—ä¸é‡æ–°åˆ†é…(æŠŠæ‰€æœ‰ä¸œè¥¿å¤åˆ¶è¿‡æ¥)18æ¬¡ã€‚ä½†æ—¢ç„¶æˆ‘ä»¬çŸ¥é“äº†æœ€ç»ˆçš„å®¹é‡ï¼Œæˆ‘ä»¬å¯ä»¥é©¬ä¸Šè®¾ç½®å®¹é‡ï¼Œä¸éœ€è¦é‡æ–°åˆ†é…:åªè®¾ç½®ä¸€æ¬¡<code>String</code>å®¹é‡å°±å¤Ÿäº†ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let mut push_string = String::with_capacity(4587520); // We know the exact number. Some different big number could work too
    let mut capacity_counter = 0;
    for _ in 0..100_000 {
        if push_string.capacity() != capacity_counter {
            println!("{}", push_string.capacity());
            capacity_counter = push_string.capacity();
        }
        push_string.push_str("I'm getting pushed into the string!");
    }
}</code></pre></pre>
<p>è€Œè¿™ä¸ªæ‰“å°<code>4587520</code>ã€‚å®Œç¾çš„! æˆ‘ä»¬å†ä¹Ÿä¸ç”¨åˆ†é…äº†ã€‚</p>
<p>å½“ç„¶ï¼Œå®é™…é•¿åº¦è‚¯å®šæ¯”è¿™ä¸ªå°ã€‚å¦‚æœä½ è¯•äº†100001æ¬¡ï¼Œ101000æ¬¡ç­‰ç­‰ï¼Œè¿˜æ˜¯ä¼šè¯´<code>4587520</code>ã€‚è¿™æ˜¯å› ä¸ºæ¯æ¬¡çš„å®¹é‡éƒ½æ˜¯ä¹‹å‰çš„2å€ã€‚ä¸è¿‡æˆ‘ä»¬å¯ä»¥ç”¨<code>.shrink_to_fit()</code>æ¥ç¼©å°å®ƒ(å’Œ<code>Vec</code>ä¸€æ ·)ã€‚æˆ‘ä»¬çš„<code>String</code>å·²ç»éå¸¸å¤§äº†ï¼Œæˆ‘ä»¬ä¸æƒ³å†ç»™å®ƒå¢åŠ ä»»ä½•ä¸œè¥¿ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠå®ƒç¼©å°ä¸€ç‚¹ã€‚ä½†æ˜¯åªæœ‰åœ¨ä½ æœ‰æŠŠæ¡çš„æƒ…å†µä¸‹æ‰å¯ä»¥è¿™æ ·åš:ä¸‹é¢æ˜¯åŸå› ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let mut push_string = String::with_capacity(4587520);
    let mut capacity_counter = 0;
    for _ in 0..100_000 {
        if push_string.capacity() != capacity_counter {
            println!("{}", push_string.capacity());
            capacity_counter = push_string.capacity();
        }
        push_string.push_str("I'm getting pushed into the string!");
    }
    push_string.shrink_to_fit();
    println!("{}", push_string.capacity());
    push_string.push('a');
    println!("{}", push_string.capacity());
    push_string.shrink_to_fit();
    println!("{}", push_string.capacity());
}</code></pre></pre>
<p>è¿™ä¸ªæ‰“å°:</p>
<pre><code class="language-text">4587520
3500000
7000000
3500001
</code></pre>
<p>æ‰€ä»¥é¦–å…ˆæˆ‘ä»¬çš„å¤§å°æ˜¯<code>4587520</code>ï¼Œä½†æˆ‘ä»¬æ²¡æœ‰å…¨éƒ¨ä½¿ç”¨ã€‚æˆ‘ä»¬ç”¨äº†<code>.shrink_to_fit()</code>ï¼Œç„¶åæŠŠå¤§å°é™åˆ°äº†<code>3500000</code>ã€‚ä½†æ˜¯æˆ‘ä»¬å¿˜è®°äº†æˆ‘ä»¬éœ€è¦æ¨ä¸Šä¸€ä¸ª <code>a</code>ã€‚å½“æˆ‘ä»¬è¿™æ ·åšçš„æ—¶å€™ï¼ŒRust çœ‹åˆ°æˆ‘ä»¬éœ€è¦æ›´å¤šçš„ç©ºé—´ï¼Œç»™äº†æˆ‘ä»¬åŒå€çš„ç©ºé—´:ç°åœ¨æ˜¯ <code>7000000</code>ã€‚Whoops! æ‰€ä»¥æˆ‘ä»¬åˆè°ƒç”¨äº†<code>.shrink_to_fit()</code>ï¼Œç°åœ¨åˆå›åˆ°äº†<code>3500001</code>ã€‚</p>
<p><code>.pop()</code>å¯¹<code>String</code>æœ‰ç”¨ï¼Œå°±åƒå¯¹<code>Vec</code>ä¸€æ ·ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let mut my_string = String::from(".daer ot drah tib elttil a si gnirts sihT");
    loop {
        let pop_result = my_string.pop();
        match pop_result {
            Some(character) =&gt; print!("{}", character),
            None =&gt; break,
        }
    }
}</code></pre></pre>
<p>è¿™æ‰“å°çš„æ˜¯<code>This string is a little bit hard to read.</code>ï¼Œå› ä¸ºå®ƒæ˜¯ä»æœ€åä¸€ä¸ªå­—ç¬¦å¼€å§‹çš„ã€‚</p>
<p><code>.retain()</code>æ˜¯ä¸€ä¸ªä½¿ç”¨é—­åŒ…çš„æ–¹æ³•ï¼Œè¿™å¯¹<code>String</code>æ¥è¯´æ˜¯ç½•è§çš„ã€‚å°±åƒåœ¨è¿­ä»£å™¨ä¸Šçš„<code>.filter()</code>ä¸€æ ·ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let mut my_string = String::from("Age: 20 Height: 194 Weight: 80");
    my_string.retain(|character| character.is_alphabetic() || character == ' '); // Keep if a letter or a space
    dbg!(my_string); // Let's use dbg!() for fun this time instead of println!
}</code></pre></pre>
<p>è¿™ä¸ªæ‰“å°:</p>
<pre><code class="language-text">[src\main.rs:4] my_string = "Age  Height  Weight "
</code></pre>
<h3 id="osstringå’Œcstring"><a class="header" href="#osstringå’Œcstring">OsStringå’ŒCString</a></h3>
<p><code>std::ffi</code>æ˜¯<code>std</code>çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå¸®åŠ©ä½ å°†Rustä¸å…¶ä»–è¯­è¨€æˆ–æ“ä½œç³»ç»Ÿä¸€èµ·ä½¿ç”¨ã€‚å®ƒæœ‰<code>OsString</code>å’Œ<code>CString</code>è¿™æ ·çš„ç±»å‹ï¼Œå®ƒä»¬å°±åƒæ“ä½œç³»ç»Ÿçš„<code>String</code>æˆ–è¯­è¨€Cçš„<code>String</code>ä¸€æ ·ï¼Œå®ƒä»¬å„è‡ªä¹Ÿæœ‰è‡ªå·±çš„<code>&amp;str</code>ç±»å‹:<code>OsStr</code>å’Œ<code>CStr</code>ã€‚<code>ffi</code>çš„æ„æ€æ˜¯ "foreign function interface"(å¤–éƒ¨å‡½æ•°æ¥å£)ã€‚</p>
<p>å½“ä½ å¿…é¡»ä¸ä¸€ä¸ªæ²¡æœ‰Unicodeçš„æ“ä½œç³»ç»Ÿä¸€èµ·å·¥ä½œæ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>OsString</code>ã€‚æ‰€æœ‰çš„Rustå­—ç¬¦ä¸²éƒ½æ˜¯unicodeï¼Œä½†ä¸æ˜¯æ¯ä¸ªæ“ä½œç³»ç»Ÿæ”¯æŒã€‚ä¸‹é¢æ˜¯æ ‡å‡†åº“ä¸­å…³äºä¸ºä»€ä¹ˆæˆ‘ä»¬æœ‰<code>OsString</code>çš„ç®€å•è‹±æ–‡è§£é‡Šã€‚</p>
<ul>
<li>Unixç³»ç»Ÿ(Linuxç­‰)ä¸Šçš„å­—ç¬¦ä¸²å¯èƒ½æ˜¯å¾ˆå¤šæ²¡æœ‰0çš„å­—èŠ‚ç»„åˆåœ¨ä¸€èµ·ã€‚è€Œä¸”æœ‰æ—¶ä½ ä¼šæŠŠå®ƒä»¬è¯»æˆUnicode UTF-8ã€‚</li>
<li>Windowsä¸Šçš„å­—ç¬¦ä¸²å¯èƒ½æ˜¯ç”±éšæœºçš„16ä½å€¼ç»„æˆçš„ï¼Œæ²¡æœ‰0ã€‚æœ‰æ—¶ä½ ä¼šæŠŠå®ƒä»¬è¯»æˆUnicode UTF-16ã€‚</li>
<li>åœ¨Rustä¸­ï¼Œå­—ç¬¦ä¸²æ€»æ˜¯æœ‰æ•ˆçš„UTF-8ï¼Œå…¶ä¸­å¯èƒ½åŒ…å«0ã€‚</li>
</ul>
<p>æ‰€ä»¥ï¼Œ<code>OsString</code>è¢«è®¾è®¡ä¸ºæ”¯æŒå®ƒä»¬è¯»å–ã€‚</p>
<p>ä½ å¯ä»¥ç”¨ä¸€ä¸ª<code>OsString</code>åšæ‰€æœ‰å¸¸è§„çš„äº‹æƒ…ï¼Œæ¯”å¦‚<code>OsString::from("Write something here")</code>ã€‚å®ƒè¿˜æœ‰ä¸€ä¸ªæœ‰è¶£çš„æ–¹æ³•ï¼Œå«åš <code>.into_string()</code>ï¼Œè¯•å›¾æŠŠè‡ªå·±å˜æˆä¸€ä¸ªå¸¸è§„çš„ <code>String</code>ã€‚å®ƒè¿”å›ä¸€ä¸ª <code>Result</code>ï¼Œä½† <code>Err</code> éƒ¨åˆ†åªæ˜¯åŸæ¥çš„ <code>OsString</code>ã€‚</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// ğŸš§
pub fn into_string(self) -&gt; Result&lt;String, OsString&gt;
<span class="boring">}</span></code></pre></pre>
<p>æ‰€ä»¥å¦‚æœä¸è¡Œçš„è¯ï¼Œé‚£ä½ å°±æŠŠå®ƒæ‰¾å›æ¥ã€‚ä½ ä¸èƒ½è°ƒç”¨<code>.unwrap()</code>ï¼Œå› ä¸ºå®ƒä¼šå´©æºƒï¼Œä½†æ˜¯ä½ å¯ä»¥ä½¿ç”¨<code>match</code>æ¥æ‰¾å›<code>OsString</code>ã€‚æˆ‘ä»¬é€šè¿‡è°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•æ¥æµ‹è¯•ä¸€ä¸‹ã€‚</p>
<pre><pre class="playground"><code class="language-rust">use std::ffi::OsString;

fn main() {
    // âš ï¸
    let os_string = OsString::from("This string works for your OS too.");
    match os_string.into_string() {
        Ok(valid) =&gt; valid.thth(),           // Compiler: "What's .thth()??"
        Err(not_valid) =&gt; not_valid.occg(),  // Compiler: "What's .occg()??"
    }
}</code></pre></pre>
<p>ç„¶åç¼–è¯‘å™¨å‡†ç¡®åœ°å‘Šè¯‰æˆ‘ä»¬æˆ‘ä»¬æƒ³çŸ¥é“çš„ä¸œè¥¿ã€‚</p>
<pre><code class="language-text">error[E0599]: no method named `thth` found for struct `std::string::String` in the current scope
 --&gt; src/main.rs:6:28
  |
6 |         Ok(valid) =&gt; valid.thth(),
  |                            ^^^^ method not found in `std::string::String`

error[E0599]: no method named `occg` found for struct `std::ffi::OsString` in the current scope
 --&gt; src/main.rs:7:37
  |
7 |         Err(not_valid) =&gt; not_valid.occg(),
  |                                     ^^^^ method not found in `std::ffi::OsString`
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<code>valid</code>çš„ç±»å‹æ˜¯<code>String</code>ï¼Œ<code>not_valid</code>çš„ç±»å‹æ˜¯<code>OsString</code>ã€‚</p>
<h3 id="mem"><a class="header" href="#mem">Mem</a></h3>
<p><code>std::mem</code>æœ‰ä¸€äº›éå¸¸æœ‰è¶£çš„æ–¹æ³•ã€‚æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†ä¸€äº›ï¼Œæ¯”å¦‚<code>.size_of()</code>ã€<code>.size_of_val()</code>å’Œ<code>.drop()</code>ã€‚</p>
<pre><pre class="playground"><code class="language-rust">use std::mem;

fn main() {
    println!("{}", mem::size_of::&lt;i32&gt;());
    let my_array = [8; 50];
    println!("{}", mem::size_of_val(&amp;my_array));
    let mut some_string = String::from("You can drop a String because it's on the heap");
    mem::drop(some_string);
    // some_string.clear();   If we did this it would panic
}</code></pre></pre>
<p>è¿™ä¸ªæ‰“å°:</p>
<pre><code class="language-text">4
200
</code></pre>
<p>ä¸‹é¢æ˜¯<code>mem</code>ä¸­çš„ä¸€äº›å…¶ä»–æ–¹æ³•ã€‚</p>
<p><code>swap()</code>: ç”¨è¿™ä¸ªæ–¹æ³•ä½ å¯ä»¥äº¤æ¢ä¸¤ä¸ªå˜é‡ä¹‹é—´çš„å€¼ã€‚ä½ å¯ä»¥é€šè¿‡ä¸ºæ¯ä¸ªå˜é‡åˆ›å»ºä¸€ä¸ªå¯å˜å¼•ç”¨æ¥åšã€‚å½“ä½ æœ‰ä¸¤ä¸ªä¸œè¥¿æƒ³äº¤æ¢ï¼Œè€ŒRustå› ä¸ºå€Ÿç”¨è§„åˆ™ä¸è®©ä½ äº¤æ¢æ—¶ï¼Œè¿™å¾ˆæœ‰å¸®åŠ©ã€‚æˆ–è€…åªæ˜¯å½“ä½ æƒ³å¿«é€Ÿåˆ‡æ¢ä¸¤ä¸ªä¸œè¥¿çš„æ—¶å€™ã€‚</p>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­ã€‚</p>
<pre><pre class="playground"><code class="language-rust">use std::{mem, fmt};

struct Ring { // Create a ring from Lord of the Rings
    owner: String,
    former_owner: String,
    seeker: String, // seeker means "person looking for it"
}

impl Ring {
    fn new(owner: &amp;str, former_owner: &amp;str, seeker: &amp;str) -&gt; Self {
        Self {
            owner: owner.to_string(),
            former_owner: former_owner.to_string(),
            seeker: seeker.to_string(),
        }
    }
}

impl fmt::Display for Ring { // Display to show who has it and who wants it
        fn fmt(&amp;self, f: &amp;mut fmt::Formatter&lt;'_&gt;) -&gt; fmt::Result {
            write!(f, "{} has the ring, {} used to have it, and {} wants it", self.owner, self.former_owner, self.seeker)
        }
}

fn main() {
    let mut one_ring = Ring::new("Frodo", "Gollum", "Sauron");
    println!("{}", one_ring);
    mem::swap(&amp;mut one_ring.owner, &amp;mut one_ring.former_owner); // Gollum got the ring back for a second
    println!("{}", one_ring);
}</code></pre></pre>
<p>è¿™å°†æ‰“å°:</p>
<pre><code class="language-text">Frodo has the ring, Gollum used to have it, and Sauron wants it
Gollum has the ring, Frodo used to have it, and Sauron wants it
</code></pre>
<p><code>replace()</code>:è¿™ä¸ªå°±åƒswapä¸€æ ·ï¼Œå…¶å®é‡Œé¢ä¹Ÿç”¨äº†swapï¼Œä½ å¯ä»¥çœ‹åˆ°ã€‚</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub fn replace&lt;T&gt;(dest: &amp;mut T, mut src: T) -&gt; T {
    swap(dest, &amp;mut src);
    src
}
<span class="boring">}</span></code></pre></pre>
<p>æ‰€ä»¥å®ƒåªæ˜¯åšäº†ä¸€ä¸ªäº¤æ¢ï¼Œç„¶åè¿”å›å¦ä¸€ä¸ªå…ƒç´ ã€‚æœ‰äº†è¿™ä¸ªï¼Œä½ å°±ç”¨ä½ æ”¾è¿›å»çš„å…¶ä»–ä¸œè¥¿æ¥æ›¿æ¢è¿™ä¸ªå€¼ã€‚å› ä¸ºå®ƒè¿”å›çš„æ˜¯æ—§çš„å€¼ï¼Œæ‰€ä»¥ä½ åº”è¯¥ç”¨<code>let</code>æ¥ä½¿ç”¨å®ƒã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚</p>
<pre><pre class="playground"><code class="language-rust">use std::mem;

struct City {
    name: String,
}

impl City {
    fn change_name(&amp;mut self, name: &amp;str) {
        let old_name = mem::replace(&amp;mut self.name, name.to_string());
        println!(
            "The city once called {} is now called {}.",
            old_name, self.name
        );
    }
}

fn main() {
    let mut capital_city = City {
        name: "Constantinople".to_string(),
    };
    capital_city.change_name("Istanbul");
}</code></pre></pre>
<p>è¿™æ ·å°±ä¼šæ‰“å°å‡º<code>The city once called Constantinople is now called Istanbul.</code>ã€‚</p>
<p>æœ‰ä¸€ä¸ªå‡½æ•°å«<code>.take()</code>ï¼Œå’Œ<code>.replace()</code>ä¸€æ ·ï¼Œä½†å®ƒåœ¨å…ƒç´ ä¸­ç•™ä¸‹äº†é»˜è®¤å€¼ã€‚
ä½ ä¼šè®°å¾—ï¼Œé»˜è®¤å€¼é€šå¸¸æ˜¯0ã€""ä¹‹ç±»çš„ä¸œè¥¿ã€‚è¿™é‡Œæ˜¯ç­¾åã€‚</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// ğŸš§
pub fn take&lt;T&gt;(dest: &amp;mut T) -&gt; T
where
    T: Default,
<span class="boring">}</span></code></pre></pre>
<p>æ‰€ä»¥ä½ å¯ä»¥åšè¿™æ ·çš„äº‹æƒ…ã€‚</p>
<pre><pre class="playground"><code class="language-rust">use std::mem;

fn main() {
    let mut number_vec = vec![8, 7, 0, 2, 49, 9999];
    let mut new_vec = vec![];

    number_vec.iter_mut().for_each(|number| {
        let taker = mem::take(number);
        new_vec.push(taker);
    });

    println!("{:?}\n{:?}", number_vec, new_vec);
}</code></pre></pre>
<p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œå®ƒå°†æ‰€æœ‰æ•°å­—éƒ½æ›¿æ¢ä¸º0:æ²¡æœ‰åˆ é™¤ä»»ä½•ç´¢å¼•ã€‚</p>
<pre><code class="language-text">[0, 0, 0, 0, 0, 0]
[8, 7, 0, 2, 49, 9999]
</code></pre>
<p>å½“ç„¶ï¼Œå¯¹äºä½ è‡ªå·±çš„ç±»å‹ï¼Œä½ å¯ä»¥æŠŠ<code>Default</code>å®ç°æˆä»»ä½•ä½ æƒ³è¦çš„ç±»å‹ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª<code>Bank</code>å’Œä¸€ä¸ª<code>Robber</code>ã€‚æ¯æ¬¡ä»–æŠ¢äº†<code>Bank</code>ï¼Œä»–å°±ä¼šåœ¨æ¡Œå­ä¸Šæ‹¿åˆ°é’±ã€‚ä½†æ˜¯åŠå…¬æ¡Œå¯ä»¥éšæ—¶ä»åé¢æ‹¿é’±ï¼Œæ‰€ä»¥å®ƒæ°¸è¿œæœ‰50ã€‚æˆ‘ä»¬å°†ä¸ºæ­¤è‡ªåˆ¶ä¸€ä¸ªç±»å‹ï¼Œæ‰€ä»¥å®ƒå°†æ°¸è¿œæœ‰50ã€‚ä¸‹é¢æ˜¯å®ƒçš„å·¥ä½œåŸç†ã€‚</p>
<pre><pre class="playground"><code class="language-rust">use std::mem;
use std::ops::{Deref, DerefMut}; // We will use this to get the power of u32

struct Bank {
    money_inside: u32,
    money_at_desk: DeskMoney, // This is our "smart pointer" type. It has its own default, but it will use u32
}

struct DeskMoney(u32);

impl Default for DeskMoney {
    fn default() -&gt; Self {
        Self(50) // default is always 50, not 0
    }
}

impl Deref for DeskMoney { // With this we can access the u32 using *
    type Target = u32;

    fn deref(&amp;self) -&gt; &amp;Self::Target {
        &amp;self.0
    }
}

impl DerefMut for DeskMoney { // And with this we can add, subtract, etc.
    fn deref_mut(&amp;mut self) -&gt; &amp;mut Self::Target {
        &amp;mut self.0
    }
}

impl Bank {
    fn check_money(&amp;self) {
        println!(
            "There is ${} in the back and ${} at the desk.\n",
            self.money_inside, *self.money_at_desk // Use * so we can just print the u32
        );
    }
}

struct Robber {
    money_in_pocket: u32,
}

impl Robber {
    fn check_money(&amp;self) {
        println!("The robber has ${} right now.\n", self.money_in_pocket);
    }

    fn rob_bank(&amp;mut self, bank: &amp;mut Bank) {
        let new_money = mem::take(&amp;mut bank.money_at_desk); // Here it takes the money, and leaves 50 because that is the default
        self.money_in_pocket += *new_money; // Use * because we can only add u32. DeskMoney can't add
        bank.money_inside -= *new_money;    // Same here
        println!("She robbed the bank. She now has ${}!\n", self.money_in_pocket);
    }
}

fn main() {
    let mut bank_of_klezkavania = Bank { // Set up our bank
        money_inside: 5000,
        money_at_desk: DeskMoney(50),
    };
    bank_of_klezkavania.check_money();

    let mut robber = Robber { // Set up our robber
        money_in_pocket: 50,
    };
    robber.check_money();

    robber.rob_bank(&amp;mut bank_of_klezkavania); // Rob, then check money
    robber.check_money();
    bank_of_klezkavania.check_money();

    robber.rob_bank(&amp;mut bank_of_klezkavania); // Do it again
    robber.check_money();
    bank_of_klezkavania.check_money();

}</code></pre></pre>
<p>è¿™å°†æ‰“å°:</p>
<pre><code class="language-text">There is $5000 in the back and $50 at the desk.

The robber has $50 right now.

She robbed the bank. She now has $100!

The robber has $100 right now.

There is $4950 in the back and $50 at the desk.

She robbed the bank. She now has $150!

The robber has $150 right now.

There is $4900 in the back and $50 at the desk.
</code></pre>
<p>ä½ å¯ä»¥çœ‹åˆ°æ¡Œå­ä¸Šæ€»æ˜¯æœ‰50ç¾å…ƒã€‚</p>
<h3 id="prelude"><a class="header" href="#prelude">Prelude</a></h3>
<p>æ ‡å‡†åº“ä¹Ÿæœ‰ä¸€ä¸ªpreludeï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ ä¸ç”¨å†™<code>use std::vec::Vec</code>è¿™æ ·çš„ä¸œè¥¿æ¥åˆ›å»ºä¸€ä¸ª<code>Vec</code>ã€‚ä½ å¯ä»¥<a href="https://doc.rust-lang.org/std/prelude/index.html#prelude-contents">åœ¨è¿™é‡Œ</a>çœ‹åˆ°æ‰€æœ‰è¿™äº›å…ƒç´ ï¼Œå¹¶ä¸”å¤§è‡´äº†è§£:</p>
<ul>
<li><code>std::marker::{Copy, Send, Sized, Sync, Unpin}</code>. ä½ ä»¥å‰æ²¡æœ‰è§è¿‡<code>Unpin</code>ï¼Œå› ä¸ºå‡ ä¹æ¯ä¸€ç§ç±»å‹éƒ½ä¼šç”¨åˆ°å®ƒ(æ¯”å¦‚<code>Sized</code>ï¼Œä¹Ÿå¾ˆå¸¸è§)ã€‚"Pin"çš„æ„æ€æ˜¯ä¸è®©ä¸œè¥¿åŠ¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<code>Pin</code>æ„å‘³ç€å®ƒåœ¨å†…å­˜ä¸­ä¸èƒ½ç§»åŠ¨ï¼Œä½†å¤§å¤šæ•°å…ƒç´ éƒ½æœ‰<code>Unpin</code>ï¼Œæ‰€ä»¥ä½ å¯ä»¥ç§»åŠ¨ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåƒ<code>std::mem::replace</code>è¿™æ ·çš„å‡½æ•°èƒ½ç”¨ï¼Œå› ä¸ºå®ƒä»¬æ²¡æœ‰è¢«é’‰ä½ã€‚</li>
<li><code>std::ops::{Drop, Fn, FnMut, FnOnce}</code>.</li>
<li><code>std::mem::drop</code></li>
<li><code>std::boxed::Box</code>.</li>
<li><code>std::borrow::ToOwned</code>. ä½ ä¹‹å‰ç”¨<code>Cow</code>çœ‹åˆ°è¿‡ä¸€ç‚¹ï¼Œå®ƒå¯ä»¥æŠŠå€Ÿæ¥çš„å†…å®¹å˜æˆè‡ªå·±çš„ã€‚å®ƒä½¿ç”¨<code>.to_owned()</code>æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨<code>&amp;str</code>ä¸Šä½¿ç”¨<code>.to_owned()</code>ï¼Œå¾—åˆ°ä¸€ä¸ª<code>String</code>ï¼Œå¯¹äºå…¶ä»–å€Ÿæ¥çš„å€¼ä¹Ÿæ˜¯ä¸€æ ·ã€‚</li>
<li><code>std::clone::Clone</code></li>
<li><code>std::cmp::{PartialEq, PartialOrd, Eq, Ord}</code>.</li>
<li><code>std::convert::{AsRef, AsMut, Into, From}</code>.</li>
<li><code>std::default::Default</code>.</li>
<li><code>std::iter::{Iterator, Extend, IntoIterator, DoubleEndedIterator, ExactSizeIterator}</code>. æˆ‘ä»¬ä¹‹å‰ç”¨<code>.rev()</code>æ¥åšè¿­ä»£å™¨:è¿™å®é™…ä¸Šæ˜¯åšäº†ä¸€ä¸ª<code>DoubleEndedIterator</code>ã€‚<code>ExactSizeIterator</code>åªæ˜¯ç±»ä¼¼äº<code>0..10</code>çš„ä¸œè¥¿:å®ƒå·²ç»çŸ¥é“è‡ªå·±çš„<code>.len()</code>æ˜¯10ã€‚å…¶ä»–è¿­ä»£å™¨ä¸çŸ¥é“å®ƒä»¬çš„é•¿åº¦æ˜¯è‚¯å®šçš„ã€‚</li>
<li><code>std::option::Option::{self, Some, None}</code>.</li>
<li><code>std::result::Result::{self, Ok, Err}</code>.</li>
<li><code>std::string::{String, ToString}</code>.</li>
<li><code>std::vec::Vec</code>.</li>
</ul>
<p>å¦‚æœä½ å› ä¸ºæŸäº›åŸå› ä¸æƒ³è¦è¿™ä¸ªpreludeæ€ä¹ˆåŠï¼Ÿå°±åŠ å±æ€§<code>#![no_implicit_prelude]</code>ã€‚æˆ‘ä»¬æ¥è¯•ä¸€è¯•ï¼Œçœ‹ç¼–è¯‘å™¨çš„æŠ±æ€¨ã€‚</p>
<pre><pre class="playground"><code class="language-rust">// âš ï¸
#![no_implicit_prelude]
fn main() {
    let my_vec = vec![8, 9, 10];
    let my_string = String::from("This won't work");
    println!("{:?}, {}", my_vec, my_string);
}</code></pre></pre>
<p>ç°åœ¨Rustæ ¹æœ¬ä¸çŸ¥é“ä½ æƒ³åšä»€ä¹ˆã€‚</p>
<pre><code class="language-text">error: cannot find macro `println` in this scope
 --&gt; src/main.rs:5:5
  |
5 |     println!("{:?}, {}", my_vec, my_string);
  |     ^^^^^^^

error: cannot find macro `vec` in this scope
 --&gt; src/main.rs:3:18
  |
3 |     let my_vec = vec![8, 9, 10];
  |                  ^^^

error[E0433]: failed to resolve: use of undeclared type or module `String`
 --&gt; src/main.rs:4:21
  |
4 |     let my_string = String::from("This won't work");
  |                     ^^^^^^ use of undeclared type or module `String`

error: aborting due to 3 previous errors
</code></pre>
<p>å› æ­¤ï¼Œå¯¹äºè¿™ä¸ªç®€å•çš„ä»£ç ï¼Œä½ éœ€è¦å‘Šè¯‰Rustä½¿ç”¨<code>extern</code>(å¤–éƒ¨)crateï¼Œå«åš<code>std</code>ï¼Œç„¶åæ˜¯ä½ æƒ³è¦çš„å…ƒç´ ã€‚è¿™é‡Œæ˜¯æˆ‘ä»¬è¦åšçš„ä¸€åˆ‡ï¼Œåªæ˜¯ä¸ºäº†åˆ›å»ºä¸€ä¸ªVecå’Œä¸€ä¸ªStringï¼Œå¹¶æ‰“å°å®ƒã€‚</p>
<pre><pre class="playground"><code class="language-rust">#![no_implicit_prelude]

extern crate std; // Now you have to tell Rust that you want to use a crate called std
use std::vec; // We need the vec macro
use std::string::String; // and string
use std::convert::From; // and this to convert from a &amp;str to the String
use std::println; // and this to print

fn main() {
    let my_vec = vec![8, 9, 10];
    let my_string = String::from("This won't work");
    println!("{:?}, {}", my_vec, my_string);
}</code></pre></pre>
<p>ç°åœ¨ç»ˆäºæˆåŠŸäº†ï¼Œæ‰“å°å‡º<code>[8, 9, 10], This won't work</code>ã€‚æ‰€ä»¥ä½ å¯ä»¥æ˜ç™½ä¸ºä»€ä¹ˆRustè¦ç”¨preludeäº†ã€‚ä½†å¦‚æœä½ æ„¿æ„ï¼Œä½ ä¸éœ€è¦ä½¿ç”¨å®ƒã€‚è€Œä¸”ä½ ç”šè‡³å¯ä»¥ä½¿ç”¨<code>#![no_std]</code>(æˆ‘ä»¬æ›¾ç»çœ‹åˆ°è¿‡)ï¼Œç”¨äºä½ è¿å †æ ˆå†…å­˜è¿™ç§ä¸œè¥¿éƒ½ç”¨ä¸ä¸Šçš„æ—¶å€™ã€‚ä½†å¤§å¤šæ•°æ—¶å€™ï¼Œä½ æ ¹æœ¬ä¸ç”¨è€ƒè™‘ä¸ç”¨preludeæˆ–<code>std</code>ã€‚</p>
<p>é‚£ä¹ˆä¸ºä»€ä¹ˆä¹‹å‰æˆ‘ä»¬æ²¡æœ‰çœ‹åˆ°<code>extern</code>è¿™ä¸ªå…³é”®å­—å‘¢ï¼Ÿæ˜¯å› ä¸ºä½ å·²ç»ä¸éœ€è¦å®ƒäº†ã€‚ä»¥å‰ï¼Œå½“å¸¦å…¥å¤–éƒ¨crateæ—¶ï¼Œä½ å¿…é¡»ä½¿ç”¨å®ƒã€‚æ‰€ä»¥ä»¥å‰è¦ä½¿ç”¨<code>rand</code>ï¼Œä½ å¿…é¡»è¦å†™æˆ:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>extern crate rand;
<span class="boring">}</span></code></pre></pre>
<p>ç„¶åç”¨ <code>use</code> è¯­å¥æ¥è¡¨ç¤ºä½ æƒ³ä½¿ç”¨çš„ä¿®æ”¹ã€traitç­‰ã€‚ä½†ç°åœ¨Rustç¼–è¯‘å™¨å·²ç»ä¸éœ€è¦è¿™äº›å¸®åŠ©äº†--ä½ åªéœ€è¦ä½¿ç”¨<code>use</code>ï¼Œrustå°±çŸ¥é“åœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°å®ƒã€‚æ‰€ä»¥ä½ å‡ ä¹å†ä¹Ÿä¸éœ€è¦<code>extern crate</code>äº†ï¼Œä½†åœ¨å…¶ä»–äººçš„Rustä»£ç ä¸­ï¼Œä½ å¯èƒ½ä»ç„¶ä¼šåœ¨é¡¶éƒ¨çœ‹åˆ°å®ƒã€‚</p>
<h3 id="time"><a class="header" href="#time">Time</a></h3>
<p><code>std::time</code>æ˜¯ä½ å¯ä»¥æ‰¾åˆ°æ—¶é—´å‡½æ•°çš„åœ°æ–¹ã€‚(å¦‚æœä½ æƒ³è¦æ›´å¤šçš„åŠŸèƒ½ï¼Œ<code>chrono</code>è¿™æ ·çš„crateä¹Ÿå¯ä»¥ã€‚)æœ€ç®€å•çš„åŠŸèƒ½å°±æ˜¯ç”¨<code>Instant::now()</code>è·å–ç³»ç»Ÿæ—¶é—´å³å¯ã€‚</p>
<pre><pre class="playground"><code class="language-rust">use std::time::Instant;

fn main() {
    let time = Instant::now();
    println!("{:?}", time);
}</code></pre></pre>
<p>å¦‚æœä½ æ‰“å°å‡ºæ¥ï¼Œä½ ä¼šå¾—åˆ°è¿™æ ·çš„ä¸œè¥¿ã€‚<code>Instant { tv_sec: 2738771, tv_nsec: 685628140 }</code>. è¿™è¯´çš„æ˜¯ç§’å’Œçº³ç§’ï¼Œä½†ç”¨å¤„ä¸å¤§ã€‚æ¯”å¦‚ä½ çœ‹2738771ç§’(å†™äº8æœˆ)ï¼Œå°±æ˜¯31.70å¤©ã€‚è¿™å’Œæœˆä»½ã€æ—¥å­æ²¡æœ‰ä»»ä½•å…³ç³»ã€‚ä½†æ˜¯<code>Instant</code>çš„é¡µé¢å‘Šè¯‰æˆ‘ä»¬ï¼Œå®ƒæœ¬èº«ä¸åº”è¯¥æœ‰ç”¨ã€‚å®ƒè¯´å®ƒæ˜¯ "ä¸é€æ˜çš„ï¼Œåªæœ‰å’ŒDurationä¸€èµ·æ‰æœ‰ç”¨"ã€‚Opaqueçš„æ„æ€æ˜¯ "ä½ æä¸æ¸…æ¥š"ï¼Œè€ŒDurationçš„æ„æ€æ˜¯ "è¿‡äº†å¤šå°‘æ—¶é—´"ã€‚æ‰€ä»¥å®ƒåªæœ‰åœ¨åšæ¯”è¾ƒæ—¶é—´è¿™æ ·çš„äº‹æƒ…æ—¶æ‰æœ‰ç”¨ã€‚</p>
<p>å¦‚æœä½ çœ‹å·¦è¾¹çš„traitï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯<code>Sub&lt;Instant&gt;</code>ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥ç”¨<code>-</code>æ¥å‡å»ä¸€ä¸ªã€‚è€Œå½“æˆ‘ä»¬ç‚¹å‡»[src]çœ‹å®ƒçš„ä½œç”¨æ—¶ï¼Œé¡µé¢æ˜¾ç¤ºï¼š</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl Sub&lt;Instant&gt; for Instant {
    type Output = Duration;

    fn sub(self, other: Instant) -&gt; Duration {
        self.duration_since(other)
    }
}
<span class="boring">}</span></code></pre></pre>
<p>å› æ­¤ï¼Œå®ƒéœ€è¦ä¸€ä¸ª<code>Instant</code>ï¼Œå¹¶ä½¿ç”¨<code>.duration_since()</code>ç»™å‡ºä¸€ä¸ª<code>Duration</code>ã€‚è®©æˆ‘ä»¬è¯•ç€æ‰“å°ä¸€ä¸‹ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸¤ä¸ªç›¸é‚»çš„ <code>Instant::now()</code>ï¼Œç„¶åè®©ç¨‹åºå¿™æ´»ä¸€ä¼šå„¿ï¼Œå†åˆ›å»ºä¸€ä¸ª <code>Instant::now()</code>ã€‚ç„¶åæˆ‘ä»¬å†åˆ›å»ºä¸€ä¸ª<code>Instant::now()</code>. æœ€åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ç”¨äº†å¤šé•¿æ—¶é—´ã€‚</p>
<pre><pre class="playground"><code class="language-rust">use std::time::Instant;

fn main() {
    let time1 = Instant::now();
    let time2 = Instant::now(); // These two are right next to each other

    let mut new_string = String::new();
    loop {
        new_string.push('áƒ¬'); // Make Rust push this Georgian letter onto the String
        if new_string.len() &gt; 100_000 { //  until it is 100,000 bytes long
            break;
        }
    }
    let time3 = Instant::now();
    println!("{:?}", time2 - time1);
    println!("{:?}", time3 - time1);
}</code></pre></pre>
<p>è¿™å°†æ‰“å°å‡ºè¿™æ ·çš„ä¸œè¥¿ã€‚</p>
<pre><code class="language-text">1.025Âµs
683.378Âµs
</code></pre>
<p>æ‰€ä»¥ï¼Œè¿™åªæ˜¯1å¾®ç§’å¤šä¸683æ¯«ç§’ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒRustç¡®å®èŠ±äº†ä¸€äº›æ—¶é—´æ¥åšã€‚</p>
<p>ä¸è¿‡æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ª<code>Instant</code>åšä¸€ä»¶æœ‰è¶£çš„äº‹æƒ…ã€‚
æˆ‘ä»¬å¯ä»¥æŠŠå®ƒå˜æˆ<code>String</code>ä¸<code>format!("{:?}", Instant::now());</code>ã€‚å®ƒçš„æ ·å­æ˜¯è¿™æ ·çš„:</p>
<pre><pre class="playground"><code class="language-rust">use std::time::Instant;

fn main() {
    let time1 = format!("{:?}", Instant::now());
    println!("{}", time1);
}</code></pre></pre>
<p>è¿™æ ·å°±ä¼šæ‰“å°å‡ºç±»ä¼¼<code>Instant { tv_sec: 2740773, tv_nsec: 632821036 }</code>çš„ä¸œè¥¿ã€‚è¿™æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬ä½¿ç”¨ <code>.iter()</code> å’Œ <code>.rev()</code> ä»¥åŠ <code>.skip(2)</code>ï¼Œæˆ‘ä»¬å¯ä»¥è·³è¿‡æœ€åçš„ <code>}</code> å’Œ <code> </code>ã€‚æˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥åˆ›å»ºä¸€ä¸ªéšæœºæ•°å‘ç”Ÿå™¨ã€‚</p>
<pre><pre class="playground"><code class="language-rust">use std::time::Instant;

fn bad_random_number(digits: usize) {
    if digits &gt; 9 {
        panic!("Random number can only be up to 9 digits");
    }
    let now = Instant::now();
    let output = format!("{:?}", now);

    output
        .chars()
        .rev()
        .skip(2)
        .take(digits)
        .for_each(|character| print!("{}", character));
    println!();
}

fn main() {
    bad_random_number(1);
    bad_random_number(1);
    bad_random_number(3);
    bad_random_number(3);
}</code></pre></pre>
<p>è¿™æ ·å°±ä¼šæ‰“å°å‡ºç±»ä¼¼è¿™æ ·çš„å†…å®¹:</p>
<pre><code class="language-text">6
4
967
180
</code></pre>
<p>è¿™ä¸ªå‡½æ•°è¢«ç§°ä¸º<code>bad_random_number</code>ï¼Œå› ä¸ºå®ƒä¸æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„éšæœºæ•°ç”Ÿæˆå™¨ã€‚Rustæœ‰æ›´å¥½çš„crateï¼Œå¯ä»¥ç”¨æ¯”<code>rand</code>æ›´å°‘çš„ä»£ç åˆ›å»ºéšæœºæ•°ï¼Œæ¯”å¦‚<code>fastrand</code>ã€‚ä½†è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œä½ å¯ä»¥åˆ©ç”¨ä½ çš„æƒ³è±¡åŠ›ç”¨<code>Instant</code>æ¥åšä¸€äº›äº‹æƒ…ã€‚</p>
<p>å½“ä½ æœ‰ä¸€ä¸ªçº¿ç¨‹æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>std::thread::sleep</code>ä½¿å®ƒåœæ­¢ä¸€æ®µæ—¶é—´ã€‚å½“ä½ è¿™æ ·åšæ—¶ï¼Œä½ å¿…é¡»ç»™å®ƒä¸€ä¸ªdurationã€‚ä½ ä¸å¿…åˆ›å»ºå¤šä¸ªçº¿ç¨‹æ¥åšè¿™ä»¶äº‹ï¼Œå› ä¸ºæ¯ä¸ªç¨‹åºè‡³å°‘åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸Šã€‚<code>sleep</code>è™½ç„¶éœ€è¦ä¸€ä¸ª<code>Duration</code>ï¼Œæ‰€ä»¥å®ƒå¯ä»¥çŸ¥é“è¦ç¡å¤šä¹…ã€‚ä½ å¯ä»¥è¿™æ ·é€‰å•ä½:<code>Duration::from_millis()</code>, <code>Duration::from_secs</code>, ç­‰ç­‰ã€‚è¿™é‡Œä¸¾ä¸€ä¸ªä¾‹å­:</p>
<pre><pre class="playground"><code class="language-rust">use std::time::Duration;
use std::thread::sleep;

fn main() {
    let three_seconds = Duration::from_secs(3);
    println!("I must sleep now.");
    sleep(three_seconds);
    println!("Did I miss anything?");
}</code></pre></pre>
<p>è¿™å°†åªæ‰“å°</p>
<pre><code class="language-text">I must sleep now.
Did I miss anything?
</code></pre>
<p>ä½†çº¿ç¨‹åœ¨ä¸‰ç§’é’Ÿå†…ä»€ä¹ˆä¹Ÿä¸åšã€‚å½“ä½ æœ‰å¾ˆå¤šçº¿ç¨‹éœ€è¦ç»å¸¸å°è¯•ä¸€äº›äº‹æƒ…æ—¶ï¼Œæ¯”å¦‚è¿æ¥ï¼Œä½ é€šå¸¸ä¼šä½¿ç”¨<code>.sleep()</code>ã€‚ä½ ä¸å¸Œæœ›çº¿ç¨‹åœ¨ä¸€ç§’é’Ÿå†…ä½¿ç”¨ä½ çš„å¤„ç†å™¨å°è¯•10ä¸‡æ¬¡ï¼Œè€Œä½ åªæ˜¯æƒ³è®©å®ƒæœ‰æ—¶æ£€æŸ¥ä¸€ä¸‹ã€‚æ‰€ä»¥ï¼Œä½ å°±å¯ä»¥è®¾ç½®ä¸€ä¸ª<code>Duration</code>ï¼Œå®ƒå°±ä¼šåœ¨æ¯æ¬¡é†’æ¥çš„æ—¶å€™å°è¯•åšå®ƒçš„ä»»åŠ¡ã€‚</p>
<h3 id="å…¶ä»–å®"><a class="header" href="#å…¶ä»–å®">å…¶ä»–å®</a></h3>
<p>æˆ‘ä»¬å†æ¥çœ‹çœ‹å…¶ä»–ä¸€äº›å®ã€‚</p>
<p><code>unreachable!()</code></p>
<p>è¿™ä¸ªå®æœ‰ç‚¹åƒ<code>todo!()</code>ï¼Œé™¤äº†å®ƒæ˜¯é’ˆå¯¹ä½ æ°¸è¿œä¸ä¼šç”¨çš„ä»£ç ã€‚ä¹Ÿè®¸ä½ åœ¨ä¸€ä¸ªæšä¸¾ä¸­æœ‰ä¸€ä¸ª<code>match</code>ï¼Œä½ çŸ¥é“å®ƒæ°¸è¿œä¸ä¼šé€‰æ‹©å…¶ä¸­çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œæ‰€ä»¥ä»£ç æ°¸è¿œæ— æ³•è¾¾åˆ°é‚£ä¸ªåˆ†æ”¯ã€‚å¦‚æœæ˜¯è¿™æ ·ï¼Œä½ å¯ä»¥å†™<code>unreachable!()</code>ï¼Œè¿™æ ·ç¼–è¯‘å™¨å°±çŸ¥é“å¯ä»¥å¿½ç•¥è¿™éƒ¨åˆ†ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå‡è®¾ä½ æœ‰ä¸€ä¸ªç¨‹åºï¼Œå½“ä½ é€‰æ‹©ä¸€ä¸ªåœ°æ–¹å±…ä½æ—¶ï¼Œå®ƒä¼šå†™ä¸€äº›ä¸œè¥¿ã€‚åœ¨ä¹Œå…‹å…°ï¼Œé™¤äº†åˆ‡å°”è¯ºè´åˆ©ï¼Œå…¶ä»–åœ°æ–¹éƒ½ä¸é”™ã€‚ä½ çš„ç¨‹åºä¸è®©ä»»ä½•äººé€‰æ‹©åˆ‡å°”è¯ºè´åˆ©ï¼Œå› ä¸ºå®ƒç°åœ¨ä¸æ˜¯ä¸€ä¸ªå¥½åœ°æ–¹ã€‚ä½†æ˜¯è¿™ä¸ªæšä¸¾æ˜¯å¾ˆæ—©ä»¥å‰åœ¨åˆ«äººçš„ä»£ç é‡Œåšçš„ï¼Œä½ æ— æ³•æ›´æ”¹ã€‚æ‰€ä»¥åœ¨<code>match</code>çš„åˆ†æ”¯ä¸­ï¼Œä½ å¯ä»¥ç”¨è¿™ä¸ªå®ã€‚å®ƒæ˜¯è¿™æ ·çš„:</p>
<pre><pre class="playground"><code class="language-rust">enum UkrainePlaces {
    Kiev,
    Kharkiv,
    Chernobyl, // Pretend we can't change the enum - Chernobyl will always be here
    Odesa,
    Dnipro,
}

fn choose_city(place: &amp;UkrainePlaces) {
    use UkrainePlaces::*;
    match place {
        Kiev =&gt; println!("You will live in Kiev"),
        Kharkiv =&gt; println!("You will live in Kharkiv"),
        Chernobyl =&gt; unreachable!(),
        Odesa =&gt; println!("You will live in Odesa"),
        Dnipro =&gt; println!("You will live in Dnipro"),
    }
}

fn main() {
    let user_input = UkrainePlaces::Kiev; // Pretend the user input is made from some other function. The user can't choose Chernobyl, no matter what
    choose_city(&amp;user_input);
}</code></pre></pre>
<p>è¿™å°†æ‰“å°å‡º <code>You will live in Kiev</code>ã€‚</p>
<p><code>unreachable!()</code>å¯¹ä½ æ¥è¯´ä¹Ÿå¾ˆå¥½è¯»ï¼Œå› ä¸ºå®ƒæé†’ä½ ä»£ç çš„æŸäº›éƒ¨åˆ†æ˜¯ä¸å¯è®¿é—®çš„ã€‚ä¸è¿‡ä½ å¿…é¡»ç¡®å®šä»£ç ç¡®å®æ˜¯ä¸å¯è®¿é—®çš„ã€‚å¦‚æœç¼–è¯‘å™¨è°ƒç”¨<code>unreachable!()</code>ï¼Œç¨‹åºå°±ä¼šå´©æºƒã€‚</p>
<p>æ­¤å¤–ï¼Œå¦‚æœä½ æ›¾ç»æœ‰ä¸å¯è¾¾çš„ä»£ç ï¼Œè€Œç¼–è¯‘å™¨çŸ¥é“ï¼Œå®ƒä¼šå‘Šè¯‰ä½ ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­:</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let true_or_false = true;

    match true_or_false {
        true =&gt; println!("It's true"),
        false =&gt; println!("It's false"),
        true =&gt; println!("It's true"), // Whoops, we wrote true again
    }
}</code></pre></pre>
<p>å®ƒä¼šè¯´</p>
<pre><code class="language-text">warning: unreachable pattern
 --&gt; src/main.rs:7:9
  |
7 |         true =&gt; println!("It's true"),
  |         ^^^^
  |
</code></pre>
<p>ä½†æ˜¯<code>unreachable!()</code>æ˜¯ç”¨äºç¼–è¯‘å™¨æ— æ³•çŸ¥é“çš„æ—¶å€™ï¼Œå°±åƒæˆ‘ä»¬å¦ä¸€ä¸ªä¾‹å­ã€‚</p>
<p><code>column!</code>, <code>line!</code>, <code>file!</code>, <code>module_path!</code></p>
<p>è¿™å››ä¸ªå®æœ‰ç‚¹åƒ<code>dbg!()</code>ï¼Œå› ä¸ºä½ åªæ˜¯æŠŠå®ƒä»¬æ”¾è¿›ä»£ç å»ç»™ä½ è°ƒè¯•ä¿¡æ¯ã€‚ä½†æ˜¯å®ƒä»¬ä¸éœ€è¦ä»»ä½•å˜é‡--ä½ åªéœ€è¦ç”¨å®ƒä»¬å’Œæ‹¬å·ä¸€èµ·ä½¿ç”¨ï¼Œè€Œæ²¡æœ‰å…¶ä»–çš„ä¸œè¥¿ã€‚å®ƒä»¬æ”¾åˆ°ä¸€èµ·å¾ˆå®¹æ˜“å­¦:</p>
<ul>
<li><code>column!()</code>ç»™ä½ å†™çš„é‚£ä¸€åˆ—</li>
<li><code>file!()</code>ç»™ä½ å†™çš„æ–‡ä»¶çš„åç§°</li>
<li><code>line!()</code>ç»™ä½ å†™çš„é‚£è¡Œå­—ï¼Œç„¶åæ˜¯</li>
<li><code>module_path!()</code>ç»™ä½ æ¨¡å—çš„ä½ç½®ã€‚</li>
</ul>
<p>æ¥ä¸‹æ¥çš„ä»£ç åœ¨ä¸€ä¸ªç®€å•çš„ä¾‹å­ä¸­å±•ç¤ºäº†è¿™ä¸‰è€…ã€‚æˆ‘ä»¬å°†å‡è£…æœ‰æ›´å¤šçš„ä»£ç (modé‡Œé¢çš„mod)ï¼Œå› ä¸ºè¿™å°±æ˜¯æˆ‘ä»¬è¦ä½¿ç”¨è¿™äº›å®çš„åŸå› ã€‚ä½ å¯ä»¥æƒ³è±¡ä¸€ä¸ªå¤§çš„Rustç¨‹åº,å®ƒæœ‰è®¸å¤šmodå’Œæ–‡ä»¶ã€‚</p>
<pre><pre class="playground"><code class="language-rust">pub mod something {
    pub mod third_mod {
        pub fn print_a_country(input: &amp;mut Vec&lt;&amp;str&gt;) {
            println!(
                "The last country is {} inside the module {}",
                input.pop().unwrap(),
                module_path!()
            );
        }
    }
}

fn main() {
    use something::third_mod::*;
    let mut country_vec = vec!["Portugal", "Czechia", "Finland"];

    // do some stuff
    println!("Hello from file {}", file!());

    // do some stuff
    println!(
        "On line {} we got the country {}",
        line!(),
        country_vec.pop().unwrap()
    );

    // do some more stuff

    println!(
        "The next country is {} on line {} and column {}.",
        country_vec.pop().unwrap(),
        line!(),
        column!(),
    );

    // lots more code

    print_a_country(&amp;mut country_vec);
}</code></pre></pre>
<p>å®ƒæ‰“å°çš„æ˜¯è¿™æ ·çš„ã€‚</p>
<pre><code class="language-text">Hello from file src/main.rs
On line 23 we got the country Finland
The next country is Czechia on line 32 and column 9.
The last country is Portugal inside the module rust_book::something::third_mod
</code></pre>
<p><code>cfg!</code></p>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>#[cfg(test)]</code> å’Œ <code>#[cfg(windows)]</code> è¿™æ ·çš„å±æ€§æ¥å‘Šè¯‰ç¼–è¯‘å™¨åœ¨æŸäº›æƒ…å†µä¸‹è¯¥æ€ä¹ˆåšã€‚å½“ä½ æœ‰<code>test</code>æ—¶ï¼Œå½“ä½ åœ¨æµ‹è¯•æ¨¡å¼ä¸‹è¿è¡ŒRustæ—¶ï¼Œå®ƒä¼šè¿è¡Œä»£ç (å¦‚æœæ˜¯åœ¨ç”µè„‘ä¸Šï¼Œä½ è¾“å…¥<code>cargo test</code>)ã€‚è€Œå½“ä½ ä½¿ç”¨<code>windows</code>æ—¶ï¼Œå¦‚æœç”¨æˆ·ä½¿ç”¨çš„æ˜¯Windowsï¼Œå®ƒå°±ä¼šè¿è¡Œä»£ç ã€‚ä½†ä¹Ÿè®¸ä½ åªæ˜¯æƒ³æ ¹æ®ä¸åŒæ“ä½œç³»ç»Ÿå¯¹ä¾èµ–ç³»ç»Ÿçš„ä»£ç åšå¾ˆå°çš„ä¿®æ”¹ã€‚è¿™æ—¶å€™è¿™ä¸ªå®å°±å¾ˆæœ‰ç”¨äº†ã€‚å®ƒè¿”å›ä¸€ä¸ª<code>bool</code>ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let helpful_message = if cfg!(target_os = "windows") { "backslash" } else { "slash" };

    println!(
        "...then in your hard drive, type the directory name followed by a {}. Then you...",
        helpful_message
    );
}</code></pre></pre>
<p>è¿™å°†ä»¥ä¸åŒçš„æ–¹å¼æ‰“å°ï¼Œå–å†³äºä½ çš„ç³»ç»Ÿã€‚Rust Playgroundåœ¨Linuxä¸Šè¿è¡Œï¼Œæ‰€ä»¥ä¼šæ‰“å°:</p>
<pre><code class="language-text">...then in your hard drive, type the directory name followed by a slash. Then you...
</code></pre>
<p><code>cfg!()</code>é€‚ç”¨äºä»»ä½•ä¸€ç§é…ç½®ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œå½“ä½ åœ¨æµ‹è¯•ä¸­ä½¿ç”¨ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œå®ƒçš„è¿è¡Œæ–¹å¼ä¼šæœ‰æ‰€ä¸åŒã€‚</p>
<pre><pre class="playground"><code class="language-rust">#[cfg(test)] // cfg! will know to look for the word test
mod testing {
    use super::*;
    #[test]
    fn check_if_five() {
        assert_eq!(bring_number(true), 5); // This bring_number() function should return 5
    }
}

fn bring_number(should_run: bool) -&gt; u32 { // This function takes a bool as to whether it should run
    if cfg!(test) &amp;&amp; should_run { // if it should run and has the configuration test, return 5
        5
    } else if should_run { // if it's not a test but it should run, print something. When you run a test it ignores println! statements
        println!("Returning 5. This is not a test");
        5
    } else {
        println!("This shouldn't run, returning 0."); // otherwise return 0
        0
    }
}

fn main() {
    bring_number(true);
    bring_number(false);
}</code></pre></pre>
<p>ç°åœ¨æ ¹æ®é…ç½®çš„ä¸åŒï¼Œå®ƒçš„è¿è¡Œæ–¹å¼ä¹Ÿä¼šä¸åŒã€‚å¦‚æœä½ åªæ˜¯è¿è¡Œç¨‹åºï¼Œå®ƒä¼šç»™ä½ è¿™æ ·çš„ç»“æœ:</p>
<pre><code class="language-text">Returning 5. This is not a test
This shouldn't run, returning 0.
</code></pre>
<p>ä½†å¦‚æœä½ åœ¨æµ‹è¯•æ¨¡å¼ä¸‹è¿è¡Œå®ƒ(<code>cargo test</code>ï¼Œç”¨äºç”µè„‘ä¸Šçš„Rust)ï¼Œå®ƒå®é™…ä¸Šä¼šè¿è¡Œæµ‹è¯•ã€‚å› ä¸ºåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæµ‹è¯•æ€»æ˜¯è¿”å›5ï¼Œæ‰€ä»¥å®ƒä¼šé€šè¿‡ã€‚</p>
<pre><code class="language-text">running 1 test
test testing::check_if_five ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="Chapter_59.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="Chapter_61.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="Chapter_59.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="Chapter_61.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
